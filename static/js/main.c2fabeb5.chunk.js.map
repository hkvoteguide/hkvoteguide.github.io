{"version":3,"sources":["../node_modules/encoding/lib sync","constants/dcregion.js","ui/theme/main.js","components/charts/StackedNormalizedHorizontalBarChart.js","components/containers/CampCompareChartContainer.js","components/atoms/Text.js","pages/index.js","utils/features.js","pages/search/AddressSearcher.js","reducers/drawer.js","ContextStore.js","queries/gql.js","pages/search/DistrictSelector.js","pages/search/index.js","components/organisms/ScrollableTabs.js","utils/helper.js","components/templates/CouncillorMeetingAttendance.js","components/containers/CouncillorMeetingAttendanceContainer.js","components/molecules/Card.js","components/templates/PersonElectionHistories.js","components/containers/PersonElectionHistoriesContainer.js","pages/profile/index.js","components/OLMap.js","ui/responsive.js","components/district/DistrictCard.js","components/district/MainAreas.js","components/district/CandidateList.js","components/district/VoterTurnoutChart.js","components/charts/WaffleChart.js","components/district/Metrics.js","pages/district/index.js","components/DCCACompareMap.js","components/atoms/Tag.js","components/atoms/UnstyledLink.js","components/district/Councillor.js","components/charts/GroupedBarChart.js","components/containers/DistrictNewVoterChartContainer.js","components/atoms/Columns.js","components/atoms/Rows.js","components/district/DCCAOverview.js","pages/battleground/index.js","ui/theme/index.js","pages/notfound/index.js","components/organisms/MobileAppBar.js","components/organisms/Footer.js","WithTracker.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","DCREGION","A","zh_hk","en_us","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","FONT_FAMILY","typography","useNextVariants","fontSize","fontFamily","join","h1","h2","fontWeight","h3","h4","h5","h6","body1","lineHeight","body2","createMuiTheme","palette","primary","main","contrastText","secondary","button","styledComponentTheme","backgroundColor","color","dark","camp","democracy","establishment","localist","other","uncertain","secondaryBackgroundColor","subtextColor","StackedNormalizedHorizontalBarChart","props","_useState","useState","width","height","_useState2","Object","slicedToArray","dimensions","setDimensions","d3Container","useRef","useEffect","data","margin","length","series","d3","columns","slice","offset","domain","map","d","key","range","unknown","y","name","padding","x","svg","current","append","attr","selectAll","enter","i","bandwidth","call","g","style","concat","ticks","remove","tickSizeOuter","middle","legend","text","drawChart","useLayoutEffect","clientWidth","react_default","a","createElement","Fragment","ref","Container","styled","div","_templateObject","FETCH_CAMP_DATA","gql","_templateObject2","CampCompareChartContainer","react_apollo_esm","query","variables","year","_ref2","loading","error","dataForD3","res","建制","count","泛民","其他","total","values","reduce","acc","c","convertToD3Compatible","candidates","byCodes","_","groupBy","candidate","cacode","r","defineProperty","p","val","assign","forEach","k","groupDataByRegionAndCamp","dcd_candidates","Typography","Text_templateObject","theme","TitleText","variant","pages_templateObject","TopSection","pages_templateObject2","ExpandedRow","Box","_templateObject3","LandingIcon","_templateObject4","IndexPage","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","state","autoCompleteList","type","pages_Container","Text_TitleText","containers_CampCompareChartContainer","Component","withStyles","withTheme","getAllFeaturesFromPoint","_ref","lng","lat","pt","turf","result","dc2019","features","feature","poly","geometry","coordinates","properties","CACODE","renderInputComponent","inputProps","classes","_inputProps$inputRef","inputRef","objectWithoutProperties","TextField","fullWidth","InputProps","node","input","disableUnderline","endAdornment","InputAdornment","position","IconButton","className","searchButton","aria-label","Search_default","renderSuggestion","suggestion","isHighlighted","matches","match","label","parts","parse","MenuItem","selected","component","part","index","highlight","String","getSuggestionValue","IntegrationAutosuggest","value","suggestions","debounced","handleSuggestionsFetchRequested","cancel","debounce","getSuggestions","then","setState","handleSuggestionsClearRequested","handleChange","event","_ref3","newValue","handleSuggestionSelected","_ref4","constituency","suggestionValue","suggestionIndex","sectionIndex","method","coordinate","handleAddressSelected","inputValue","trim","toLowerCase","AddressParser","records","filter","record","fullAddress","LANG_ZH","_this2","autosuggestProps","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","root","dist_default","placeholder","onChange","popperNode","InputLabelProps","shrink","suggestionsList","suggestInput","renderSuggestionsContainer","options","Paper","square","containerProps","children","React","flexGrow","container","suggestionsContainerOpen","zIndex","marginTop","spacing","display","listStyleType","borderRadius","boxShadow","textDecoration","DRAWER_OPEN","DRAWER_CLOSE","drawer","action","open","drawerInitialState","ContextStore","createContext","CONSTITUENCIES_DATA","QUERY_CONSTITUENCIES","gql_templateObject","QUERY_CONSTITUENCY_STATS","gql_templateObject2","QUERY_GET_AREA","gql_templateObject3","QUERY_GET_PERSON_ELECTIONS","gql_templateObject4","QUERY_GET_PERSON_MEETING_ATTENDANCES","_templateObject5","DistrictSelector_templateObject","DistrictContainer","Button","DistrictSelector_templateObject2","withRouter","dispatch","useContext","DistrictSelector_Container","dcd_districts","ExpansionPanel","dc_code","ExpansionPanelSummary","aria-controls","dc_name_zh","ExpansionPanelDetails","district","constituencies","onClick","history","push","name_zh","StyledDivier","Divider","search_templateObject","search_templateObject2","search_templateObject3","ContentRowContainer","search_templateObject4","AddressSearchContainer","search_templateObject5","TabContainer","_templateObject6","TabButton","_templateObject7","active","NavBarButton","_templateObject8","_React$useState","selectedTab","_React$useState2","setSelectedTab","onTabSelected","tab","search_Container","Close_default","AddressSearcher","search_DistrictSelector","TabPanel","role","aria-labelledby","ScrollableTabsButtonAuto","titles","AppBar","Tabs","title","Tab","child","hidden","getColorFromCamp","本土","傘兵","自決","不明","getColorFromPoliticalAffiliation","pa","mapping","_arr","_i","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","party","includes","err","return","MobileTableCell","TableCell","CouncillorMeetingAttendance_templateObject","CouncillorMeetingAttendace","meetings","Table","TableHead","TableRow","align","TableBody","m","scope","meeting","meet_name","meet_type","meet_year","attended","propsType","PropTypes","array","CouncillorMeetingAttendaceContainer","personId","person_id","flatten","dcd_councillors","meeting_attendances","CouncillorMeetingAttendance","int","StyledCard","Card","Card_templateObject","PlainCard","PersonElectionHistories","histories","Card_PlainCard","gutterBottom","Grid","item","xs","political_affiliation","votes","is_won","PersonElectionHistoriesContainer","templates_PersonElectionHistories","dcd_people_by_pk","GET_PEOPLE_PROFILE","profile_templateObject","FlexRowContainer","profile_templateObject2","CandidateHeaderContainer","profile_templateObject3","CandidateAvatar","Avatar","profile_templateObject4","PersonName","profile_templateObject5","YearDiv","profile_templateObject6","PersonHighlight","profile_templateObject7","ElectionHistoryPaper","profile_templateObject8","ElectionHistoryContentGrid","_templateObject9","ElectionHistoryContentSpan","_templateObject10","ElectionHistoryContentHeaderSpan","_templateObject11","ElectionDetailButton","_templateObject12","ProfilePage","handleElectionDetailButton","election","yob","md","vote_percentage","uuid","params","homeUrl","person","dcd_people","currentTerm","councillors","lastElection","personHighlight","estimated_yob","career","occupation","src","imgProps","onError","target","marginBottom","name_en","term_to","Date","containers_PersonElectionHistoriesContainer","CouncillorMeetingAttendanceContainer","MapContainer","OLMap_templateObject","regionStyle","Style","fill","Fill","stroke","Stroke","Text","font","highlightStyle","OLMap","handleMapClick","_this$props","changeDistrict","selectedFeature","getFeatures","highlightFeature","get","getView","fit","getGeometry","getExtent","duration","featuresLayer","_this$props2","dc","dc2003","dc2007","dc2011","dc2015","find","isDCDataExist","featureSource","VectorSource","GeoJSON","readFeatures","VectorLayer","source","getText","setText","getProperties","CNAME","layers","TileLayer","XYZ","url","Map","refs","mapContainer","view","View","projection","center","zoom","featureOverlay","extent","size","getSize","select","Select","addInteraction","on","highlightedFeature","getSource","removeFeature","addFeature","bps","createBreakpoints","DistrictCard_templateObject","down","InnerContainer","DistrictCard_templateObject2","YearText","DistrictCard_templateObject3","RegionText","DistrictCard_templateObject4","CodeText","DistrictCard_templateObject5","DistrictCard_templateObject6","SeperatedRow","DistrictCard_templateObject7","DistrictCard","onPrevElection","ArrowBack_default","getFullYear","onNextElection","ArrowForward_default","stations","councillor","DistrictCard_Container","border","renderPrevElectionButton","renderNextElectionButton","DistrictCard_StyledDivier","station","MainAreas_templateObject","MainAreas","areas","MainAreas_Container","flexWrap","alignContent","area","mr","CandidateList_templateObject","CandidateList","CandidateList_Container","zingchart","MODULESDIR","chartJSON","chartData","male","female","split","isNaN","parseInt","stacked","stack-type","subtitle","bold","font-size","font-color","background-color","plot","bar-width","hover-state","visible","animation","delay","sequence","valueBox","rules","rule","decimals","scale-x","tick","guide","scale-y","short","line-color","line-style","tooltip","VoterTurnoutChart","render","nextProps","nextState","JSON","stringify","exec","WaffleChart","squareValue","theData","population","units","Math","round","percentage","floor","Array","groupIndex","squareSize","row","col","QUERY_FETCH_VOTES","Metrics_templateObject","Metrics_templateObject2","_data$dc_constituenci","dc_constituencies","vote_stat","voteStats","voteStat","total_votes","total_voters","total_voted_voters","population_excluded_foreign_worker","population_excluded_foreign_worker_lte_age_15","_ref$person","getDataForWaffleChart","stats","station_stats","barVote","cur","age","gender","Metrics_Container","district_VoterTurnoutChart","charts_WaffleChart","FullWidthBox","district_templateObject","LowerBackgroundContainer","district_templateObject2","district_templateObject3","up","DistrictCardContainer","district_templateObject4","DistrictPage","handleCandidateSelected","handleChangeDistrict","_this$props$match$par","_this$props$match$par2","_this$props$match$par3","district_FlexRowContainer","sm","components_OLMap","dcd_constituencies","district_DistrictCard","bind","district_MainAreas","main_areas","Metrics","district_CandidateList","DCCACompareMap_templateObject","DCCACompareMap","DCCACompareMap_MapContainer","StyledChip","Chip","Tag_templateObject","Tag","handleClick","UnstyledLink","Link","UnstyledLink_templateObject","UnstyledNavLink","NavLink","UnstyledLink_templateObject2","StyledAvatar","Councillor_templateObject","Councillor","filteredDistricts","districts","intersect_area","predecessor","electionResults","sortedElections","sort","b","lastParticipatedYear","participationCount","relectedCount","yearResult","uncontested","myVotes","highestVotes","v","max","diff","getElectionResults","lastElectionResult","tags","to","tag","Tag_Tag","wrap","pr","alignSelf","GroupedBarChart","maxBy","chart","yScale","x0","s","x1","tickSizeInner","tickFormat","transition","random","labels","DistrictNewVoterChartContainer","filters","filterIndex","setFilterIndex","changeFilter","getDataForChat","stat","category_2","subtype","category_1","console","vote_stats","meta","increased","mostIncreasedGroup","newVotes","groupedByAge","genders","groupedByGender","types","groupedByType","newVoters","totalVoters","getMeta","Columns_templateObject","Rows_templateObject","DCCAOverview_templateObject","DCCAOverview","showGraph","voterData","new_voters_percentage","aggregations","new_voters","all_voters","toFixed","DCCAOverview_Container","Rows","Columns","marginLeft","toggleGraph","KeyboardArrowUp_default","ExpandMore_default","groupVoteStat","VOTERS","NEW_VOTERS","BattleGroundPage","candidateId","showMap","last_districts","predecessors","district_DCCAOverview","Collapse","in","components_DCCACompareMap","district_Councillor","light","background","default","NotFoundPage","MuiThemeProvider_default","href","content","StyledAppBar","MobileAppBar_templateObject","AppBarTitle","MobileAppBar_templateObject2","MobileAppBar","Toolbar","disableGutters","StyledFooter","Footer_templateObject","StyledDivider","Footer_templateObject2","StyledFooterLink","Footer_templateObject3","Footer","GoogleAnalytics","initialize","process","withTracker","WrappedComponent","arguments","trackPage","page","set","objectSpread","pageview","_React$Component","HOC","apply","inherits","createClass","location","pathname","currentPage","nextPage","client","ApolloClient","uri","Root","App_templateObject","ContentContainer","App_templateObject2","Wrapper","App_templateObject3","App","_React$useReducer","useReducer","drawerReducer","_React$useReducer2","drawerState","drawerDispatch","styled_components_browser_esm","src_ContextStore","Provider","CssBaseline","organisms_MobileAppBar","react_router","exact","path","NotfoundPage","organisms_Footer","Drawer","anchor","search","ReactDOM","react_router_dom","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.c2fabeb5.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 350;","// deprecated. should use the data from server\r\nexport const DCREGION = {\r\n  A: {\r\n    zh_hk: '中西區',\r\n    en_us: 'Central and Western',\r\n  },\r\n  B: {\r\n    zh_hk: '灣仔',\r\n    en_us: 'Wan Chai',\r\n  },\r\n  C: {\r\n    zh_hk: '東區',\r\n    en_us: 'Eastern',\r\n  },\r\n  D: {\r\n    zh_hk: '南區',\r\n    en_us: 'Southern',\r\n  },\r\n  E: {\r\n    zh_hk: '油尖旺',\r\n    en_us: 'Yau Tsim Mong',\r\n  },\r\n  F: {\r\n    zh_hk: '深水埗',\r\n    en_us: 'Sham Shui Po',\r\n  },\r\n  G: {\r\n    zh_hk: '九龍城',\r\n    en_us: 'Kowloon City',\r\n  },\r\n  H: {\r\n    zh_hk: '黃大仙',\r\n    en_us: 'Wong Tai Sin',\r\n  },\r\n  J: {\r\n    zh_hk: '觀塘',\r\n    en_us: 'Kwun Tong',\r\n  },\r\n  K: {\r\n    zh_hk: '荃灣',\r\n    en_us: 'Tsuen Wan',\r\n  },\r\n  L: {\r\n    zh_hk: '屯門',\r\n    en_us: 'Tuen Mun',\r\n  },\r\n  M: {\r\n    zh_hk: '元朗',\r\n    en_us: 'Yuen Long',\r\n  },\r\n  N: {\r\n    zh_hk: '北區',\r\n    en_us: 'North',\r\n  },\r\n  P: {\r\n    zh_hk: '大埔',\r\n    en_us: 'Tai Po',\r\n  },\r\n  Q: {\r\n    zh_hk: '西貢',\r\n    en_us: 'Sai Kung',\r\n  },\r\n  R: {\r\n    zh_hk: '沙田',\r\n    en_us: 'Sha Tin',\r\n  },\r\n  S: {\r\n    zh_hk: '葵青',\r\n    en_us: 'Kwai Tsing',\r\n  },\r\n  T: {\r\n    zh_hk: '離島',\r\n    en_us: 'Islands',\r\n  },\r\n}\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\n\r\nexport const headingFontFamily = 'Noto Sans TC, sans-serif'\r\nexport const bodyFontFamily = 'Noto Sans TC, sans-serif'\r\n\r\nexport const FONT_FAMILY = [\r\n  'Noto Sans TC',\r\n  'sans-serif',\r\n  '-apple-system',\r\n  '\"Helvetica Neue\"',\r\n  'Arial',\r\n]\r\n\r\nexport const typography = {\r\n  useNextVariants: true,\r\n  fontSize: 16,\r\n  fontFamily: FONT_FAMILY.join(','),\r\n  h1: {\r\n    fontFamily: headingFontFamily,\r\n  },\r\n  h2: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 24,\r\n    fontWeight: 500,\r\n  },\r\n  h3: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 22,\r\n    fontWeight: 500,\r\n  },\r\n  h4: {\r\n    fontFamily: FONT_FAMILY,\r\n    fontSize: 18,\r\n    fontWeight: 500,\r\n  },\r\n  h5: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 16,\r\n    fontWeight: 500,\r\n  },\r\n  h6: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 14,\r\n    fontWeight: 500,\r\n  },\r\n  body1: {\r\n    fontFamily: bodyFontFamily,\r\n    fontSize: 14,\r\n    lineHeight: 1.4,\r\n  },\r\n  body2: {\r\n    fontFamily: bodyFontFamily,\r\n    fontSize: 12,\r\n  },\r\n}\r\n\r\nexport default createMuiTheme({\r\n  typography,\r\n  palette: {\r\n    primary: {\r\n      main: '#fff',\r\n      contrastText: '#000',\r\n    },\r\n    secondary: {\r\n      main: '#3e474f',\r\n      contrastText: '#fff',\r\n    },\r\n    button: {\r\n      primary: '#ffd731',\r\n      secondary: '#ffd731',\r\n    },\r\n  },\r\n})\r\n\r\nexport const styledComponentTheme = {\r\n  main: {\r\n    backgroundColor: 'white',\r\n    color: 'black',\r\n  },\r\n  dark: {\r\n    backgroundColor: '#3e474f',\r\n    color: 'white',\r\n  },\r\n  camp: {\r\n    democracy: '#00c376',\r\n    establishment: '#ff6779',\r\n    localist: '#ffcd00',\r\n    other: '#45b6ff',\r\n    uncertain: '#a8a8ad',\r\n  },\r\n  secondaryBackgroundColor: '#f2f2f3', // grey\r\n  subtextColor: '#ffb500', // organe\r\n}\r\n","import React, { useRef, useState, useEffect, useLayoutEffect } from 'react'\r\nimport * as d3 from 'd3'\r\nimport { FONT_FAMILY } from 'ui/theme/main'\r\nconst ROW_HEIGHT = 20\r\n\r\nexport default props => {\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 })\r\n\r\n  const d3Container = useRef(null)\r\n\r\n  const drawChart = data => {\r\n    if (dimensions.width === 0) {\r\n      return\r\n    }\r\n\r\n    const margin = { top: 110, right: 15, bottom: 20, left: 50 }\r\n    const width = dimensions.width\r\n    const height = data.length * ROW_HEIGHT + margin.top + margin.bottom\r\n\r\n    const labels = ['建制', '其他', '泛民']\r\n    const series = d3\r\n      .stack()\r\n      .keys(data.columns.slice(1))\r\n      .offset(d3.stackOffsetExpand)(data)\r\n\r\n    const yAxis = g =>\r\n      g\r\n        .style('font', `12px ${FONT_FAMILY}`)\r\n        .attr('transform', `translate(${margin.left},0)`)\r\n        .call(d3.axisLeft(y).tickSizeOuter(0))\r\n        .call(g => g.selectAll('.domain').remove())\r\n\r\n    const xAxis = g =>\r\n      g\r\n        .style('font', `12px ${FONT_FAMILY}`)\r\n        .attr('transform', `translate(0,${margin.top})`)\r\n        .call(d3.axisTop(x).ticks(width / 100, '%'))\r\n        .call(g => g.selectAll('.domain').remove())\r\n\r\n    const color = d3\r\n      .scaleOrdinal()\r\n      .domain(series.map(d => d.key))\r\n      .range(['#ea3c53', '#eeeeee', '#63b9e9'])\r\n      .unknown('#ccc')\r\n\r\n    const y = d3\r\n      .scaleBand()\r\n      .domain(data.map(d => d.name))\r\n      .range([margin.top, height - margin.bottom])\r\n      .padding(0.1)\r\n\r\n    const x = d3.scaleLinear().range([margin.left, width - margin.right])\r\n\r\n    const svg = d3\r\n      .select(d3Container.current)\r\n      .append('svg')\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n    // .attr('viewBox', [0, 0, width, height])\r\n    // .style('overflow', 'visible')\r\n\r\n    svg\r\n      .append('g')\r\n      .selectAll('g')\r\n      .data(series)\r\n      .enter()\r\n      .append('g')\r\n      .attr('fill', d => color(d.key))\r\n      .selectAll('rect')\r\n      .data(d => d)\r\n      .join('rect')\r\n      .attr('x', d => x(d[0]))\r\n      .attr('y', (d, i) => y(d.data.name))\r\n      .attr('width', d => x(d[1]) - x(d[0]))\r\n      .attr('height', y.bandwidth())\r\n\r\n    svg.append('g').call(xAxis)\r\n    svg.append('g').call(yAxis)\r\n\r\n    const middle = (width + margin.left - margin.right) / 2\r\n    svg\r\n      .append('line')\r\n      .attr('x1', middle + 1)\r\n      .attr('y1', margin.top)\r\n      .attr('x2', middle + 1)\r\n      .attr('y2', height - margin.bottom)\r\n      .attr('stroke-width', 1)\r\n      .attr('stroke', '#3a3a3a')\r\n      .attr('opacity', '0.6')\r\n      .style('stroke-dasharray', '10, 4')\r\n\r\n    //Legend\r\n    const legend = svg\r\n      .selectAll('.legend')\r\n      .data(labels)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'legend')\r\n      .attr('transform', (d, i) => `translate(0, ${10 + i * 23})`)\r\n\r\n    legend\r\n      .append('rect')\r\n      .attr('x', width - margin.right - 50)\r\n      .attr('width', 18)\r\n      .attr('height', 18)\r\n      .style('fill', function(d) {\r\n        return color(d)\r\n      })\r\n\r\n    legend\r\n      .append('text')\r\n      .attr('x', width - margin.right - 20)\r\n      .attr('y', 9)\r\n      .attr('dy', '.35em')\r\n      .style('text-anchor', 'start')\r\n      .text(function(d) {\r\n        return d\r\n      })\r\n  }\r\n\r\n  useEffect(() => {\r\n    drawChart(props.data)\r\n  })\r\n\r\n  useLayoutEffect(() => {\r\n    if (d3Container.current) {\r\n      setDimensions({\r\n        width: d3Container.current.clientWidth,\r\n      })\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <>\r\n      <div ref={d3Container} style={{ height: 'auto', width: '100%' }}></div>\r\n    </>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport _ from 'lodash'\r\nimport { DCREGION } from 'constants/dcregion'\r\nimport StackedNormalizedHorizontalBarChart from 'components/charts/StackedNormalizedHorizontalBarChart'\r\n\r\nconst Container = styled.div`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n`\r\n\r\nconst FETCH_CAMP_DATA = gql`\r\n  query fetch_camp_data($year: Int!) {\r\n    dcd_candidates(where: { is_won: { _eq: true }, year: { _eq: $year } }) {\r\n      cacode\r\n      camp\r\n      person {\r\n        name_zh\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nfunction groupDataByRegionAndCamp(candidates) {\r\n  const byCodes = _.groupBy(candidates, candidate => candidate.cacode[0])\r\n  return Object.keys(byCodes).map(code => ({\r\n    code,\r\n    count: byCodes[code]\r\n      .map(r => ({ [r.camp]: 1 }))\r\n      .reduce((p, c) => {\r\n        const val = Object.assign(p)\r\n        Object.keys(c).forEach(k => (val[k] = c[k] + (val[k] ? val[k] : 0)))\r\n        return val\r\n      }, {}),\r\n  }))\r\n}\r\n\r\nfunction convertToD3Compatible(data) {\r\n  var res = data.map(d => {\r\n    return {\r\n      name: DCREGION[d.code].zh_hk,\r\n      建制: d.count['建制'] || 0,\r\n      泛民: d.count['泛民'] || 0,\r\n      其他: d.count['其他'] || 0,\r\n      total: Object.values(d.count).reduce((acc, c) => {\r\n        acc += c\r\n        return acc\r\n      }, 0),\r\n    }\r\n  })\r\n  res['columns'] = ['name', '建制', '其他', '泛民']\r\n  return res\r\n}\r\n\r\nconst CampCompareChartContainer = props => {\r\n  return (\r\n    <Query query={FETCH_CAMP_DATA} variables={{ year: 2015 }}>\r\n      {({ loading, error, data }) => {\r\n        if (loading) return null\r\n        if (error) return `Error! ${error}`\r\n\r\n        const dataFroGraph = groupDataByRegionAndCamp(data.dcd_candidates)\r\n        const dataForD3 = convertToD3Compatible(dataFroGraph)\r\n        return (\r\n          <Container>\r\n            <StackedNormalizedHorizontalBarChart\r\n              data={dataForD3}\r\n            ></StackedNormalizedHorizontalBarChart>\r\n          </Container>\r\n        )\r\n      }}\r\n    </Query>\r\n  )\r\n}\r\nexport default CampCompareChartContainer\r\n","import styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport React from 'react'\r\n\r\nconst StyledSubtTitle = styled(Typography)`\r\n  && {\r\n    color: ${props => props.theme.subtextColor};\r\n  }\r\n`\r\n\r\nexport const TitleText = props => {\r\n  return <Typography variant=\"h2\" {...props} />\r\n}\r\n\r\nexport const SubTitleText = props => {\r\n  return <StyledSubtTitle variant=\"h3\" {...props} />\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport Box from '@material-ui/core/Box'\r\nimport CampCompareChartContainer from 'components/containers/CampCompareChartContainer'\r\nimport styled from 'styled-components'\r\n\r\nimport { TitleText, SubTitleText } from 'components/atoms/Text'\r\n\r\nconst styles = theme => ({})\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  padding-top: 30px;\r\n  margin: auto;\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex-wrap: wrap;\r\n  align-items: baseline;\r\n  padding-left: 16px;\r\n  padding-right: 16px;\r\n  flex-grow: 1;\r\n`\r\n\r\nconst TopSection = styled(Container)`\r\n  && {\r\n    background-color: #f2f2f3;\r\n  }\r\n`\r\n\r\nconst ExpandedRow = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nconst LandingIcon = styled.div`\r\n  margin-top: 70px;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  width: 200px;\r\n  height: 128px;\r\n  background: url('/static/images/landingIcon.svg') no-repeat;\r\n  background-size: cover;\r\n`\r\nclass IndexPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      autoCompleteList: [],\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {}\r\n  onTabSelected(type) {}\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <TopSection>\r\n          <LandingIcon />\r\n        </TopSection>\r\n        <Container>\r\n          <ExpandedRow>\r\n            <TitleText>現屆區議會勢力分布</TitleText>\r\n            {/* <SubTitleText>了解更多</SubTitleText> */}\r\n          </ExpandedRow>\r\n          <CampCompareChartContainer />\r\n        </Container>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(IndexPage)\r\n","import * as turf from '@turf/turf'\r\n\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nexport const getAllFeaturesFromPoint = ({ lng, lat }) => {\r\n  const pt = turf.point([lng, lat])\r\n  // TODO: consider using different year in future\r\n  // but need to take care of app size\r\n  const result = {\r\n    code: null,\r\n    year: 2019,\r\n  }\r\n  for (let i = 0; i < dc2019.features.length; i++) {\r\n    const feature = dc2019.features[i]\r\n    const poly = turf.polygon(feature.geometry.coordinates)\r\n    if (turf.booleanPointInPolygon(pt, poly)) {\r\n      result.code = feature.properties.CACODE\r\n      break\r\n    }\r\n  }\r\n  return result\r\n}\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Autosuggest from 'react-autosuggest'\r\nimport match from 'autosuggest-highlight/match'\r\nimport parse from 'autosuggest-highlight/parse'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport SearchIcon from '@material-ui/icons/Search'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport * as AddressParser from 'hk-address-parser-lib'\r\nimport { getAllFeaturesFromPoint } from 'utils/features'\r\nimport _ from 'lodash'\r\n\r\nfunction renderInputComponent(inputProps) {\r\n  const { classes, inputRef = () => {}, ref, ...other } = inputProps\r\n\r\n  return (\r\n    <>\r\n      <TextField\r\n        fullWidth\r\n        InputProps={{\r\n          inputRef: node => {\r\n            ref(node)\r\n            inputRef(node)\r\n          },\r\n          classes: {\r\n            input: classes.input,\r\n          },\r\n          disableUnderline: true,\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton className={classes.searchButton} aria-label=\"Search\">\r\n                <SearchIcon />\r\n              </IconButton>\r\n            </InputAdornment>\r\n          ),\r\n        }}\r\n        {...other}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction renderSuggestion(suggestion, { query, isHighlighted }) {\r\n  const matches = match(suggestion.label, query)\r\n  const parts = parse(suggestion.label, matches)\r\n\r\n  return (\r\n    <MenuItem selected={isHighlighted} component=\"div\">\r\n      {parts.map((part, index) =>\r\n        part.highlight ? (\r\n          <span key={String(index)} style={{ fontWeight: 500 }}>\r\n            {part.text}\r\n          </span>\r\n        ) : (\r\n          <strong key={String(index)} style={{ fontWeight: 300 }}>\r\n            {part.text}\r\n          </strong>\r\n        )\r\n      )}\r\n    </MenuItem>\r\n  )\r\n}\r\n\r\nfunction getSuggestionValue(suggestion) {\r\n  return suggestion.label\r\n}\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  container: {\r\n    position: 'relative',\r\n  },\r\n  suggestionsContainerOpen: {\r\n    position: 'absolute',\r\n    zIndex: 1,\r\n    marginTop: theme.spacing(1),\r\n    // left: 0,\r\n    // right: 0,\r\n  },\r\n  suggestion: {\r\n    display: 'block',\r\n  },\r\n  suggestionsList: {\r\n    margin: 0,\r\n    padding: 0,\r\n    listStyleType: 'none',\r\n  },\r\n  suggestInput: {\r\n    height: '60px',\r\n    borderRadius: '4px',\r\n    boxShadow: '0 2px 16px 0 rgba(0, 0, 0, 0.1)',\r\n    backgroundColor: '#ffffff',\r\n    padding: '10px 20px',\r\n  },\r\n  input: {\r\n    textDecoration: 'none',\r\n  },\r\n  searchButton: {\r\n    color: '#ffd731',\r\n  },\r\n})\r\n\r\nclass IntegrationAutosuggest extends React.Component {\r\n  state = {\r\n    value: '',\r\n    suggestions: [],\r\n  }\r\n\r\n  debounced = null\r\n\r\n  async getSuggestions(value) {\r\n    const inputValue = value.trim().toLowerCase()\r\n    const inputLength = inputValue.length\r\n\r\n    if (inputLength > 0) {\r\n      const records = await AddressParser.parse(inputValue)\r\n      const result = records\r\n        .filter((_, index) => index < 10)\r\n        .map(record => ({\r\n          coordinate: record.coordinate(),\r\n          label: record.fullAddress(AddressParser.Address.LANG_ZH),\r\n        }))\r\n\r\n      return result\r\n    }\r\n\r\n    return []\r\n  }\r\n\r\n  handleSuggestionsFetchRequested = ({ value }) => {\r\n    if (this.debounced) {\r\n      this.debounced.cancel()\r\n    }\r\n    this.debounced = _.debounce(() => {\r\n      this.getSuggestions(value).then(result => {\r\n        this.setState({\r\n          suggestions: result,\r\n        })\r\n      })\r\n    }, 300)\r\n    this.debounced()\r\n  }\r\n\r\n  handleSuggestionsClearRequested = () => {\r\n    this.setState({\r\n      suggestions: [],\r\n    })\r\n  }\r\n\r\n  handleChange = name => (event, { newValue }) => {\r\n    this.setState({\r\n      [name]: newValue,\r\n    })\r\n  }\r\n\r\n  handleSuggestionSelected = (\r\n    event,\r\n    { suggestion, suggestionValue, suggestionIndex, sectionIndex, method }\r\n  ) => {\r\n    const constituency = getAllFeaturesFromPoint(suggestion.coordinate)\r\n    // TODO: better to use action to dispatch this event\r\n    this.props.handleAddressSelected(constituency)\r\n\r\n    this.setState({\r\n      value: '',\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props\r\n\r\n    const autosuggestProps = {\r\n      renderInputComponent,\r\n      suggestions: this.state.suggestions,\r\n      onSuggestionsFetchRequested: this.handleSuggestionsFetchRequested,\r\n      onSuggestionsClearRequested: this.handleSuggestionsClearRequested,\r\n      onSuggestionSelected: this.handleSuggestionSelected,\r\n      getSuggestionValue,\r\n      renderSuggestion,\r\n    }\r\n\r\n    return (\r\n      <div className={classes.root}>\r\n        <Autosuggest\r\n          {...autosuggestProps}\r\n          inputProps={{\r\n            classes,\r\n            placeholder: '尋找選區...',\r\n            value: this.state.value,\r\n            onChange: this.handleChange('value'),\r\n            inputRef: node => {\r\n              this.popperNode = node\r\n            },\r\n            InputLabelProps: {\r\n              shrink: true,\r\n            },\r\n          }}\r\n          theme={{\r\n            suggestionsList: classes.suggestionsList,\r\n            suggestion: classes.suggestion,\r\n            input: classes.suggestInput,\r\n          }}\r\n          renderSuggestionsContainer={options => (\r\n            <Paper\r\n              square\r\n              {...options.containerProps}\r\n              style={{\r\n                width: '100%',\r\n              }}\r\n            >\r\n              {options.children}\r\n            </Paper>\r\n          )}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nIntegrationAutosuggest.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n}\r\n\r\nexport default withStyles(styles)(IntegrationAutosuggest)\r\n","export const DRAWER_OPEN = 'drawer_open'\r\nexport const DRAWER_CLOSE = 'drawer_close'\r\n\r\nexport default (state, action) => {\r\n  switch (action.type) {\r\n    case DRAWER_OPEN:\r\n      return { open: true }\r\n    default:\r\n      return { open: false }\r\n  }\r\n}\r\n","import React from 'react'\r\nimport drawerReducer from 'reducers/drawer'\r\n\r\nexport const drawerInitialState = {\r\n  open: false,\r\n}\r\n\r\nconst ContextStore = React.createContext({\r\n  drawer: drawerInitialState,\r\n})\r\n\r\nexport const ContextStoreProvider = props => {\r\n  const [drawerState, drawerDispatch] = React.useReducer(\r\n    drawerReducer,\r\n    drawerInitialState\r\n  )\r\n\r\n  return (\r\n    <ContextStore.Provider\r\n      value={{\r\n        drawer: {\r\n          state: drawerState,\r\n          dispatch: drawerDispatch,\r\n        },\r\n      }}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport default ContextStore\r\n","// TODO: split this\r\nimport gql from 'graphql-tag'\r\n\r\nconst CONSTITUENCIES_DATA = `\r\nname_zh\r\nname_en\r\ndistrict {\r\n  dc_name_en\r\n  dc_name_zh\r\n  area_name_en\r\n  area_name_zh\r\n}\r\ncode\r\ndeviation_percentage\r\nexpected_population\r\nmain_areas\r\nvote_stats {\r\n  count\r\n  type\r\n  subtype\r\n  category_1\r\n  category_2\r\n}\r\nstations {\r\n  station_code\r\n  name_en\r\n  name_zh\r\n  location\r\n}\r\ntags {\r\n  tag\r\n}\r\ncouncillors {\r\n  political_affiliation\r\n  person {\r\n    id\r\n    uuid\r\n    name_zh\r\n    name_en\r\n    candidates { # to get the tags for the councilors\r\n      year\r\n      is_won\r\n      votes\r\n      constituency {\r\n        year\r\n        candidates {\r\n          person_id\r\n          votes\r\n        }\r\n      }\r\n    }\r\n    councillors { # to get the tags for the councilors\r\n      year\r\n      constituency {\r\n        code\r\n        name_zh\r\n      }\r\n    } \r\n  }\r\n}\r\ncandidates {\r\n  candidate_number\r\n  political_affiliation\r\n  camp\r\n  person {\r\n    id\r\n    uuid\r\n    name_zh\r\n    name_en\r\n    candidates { # to get the tags for the councilors\r\n      year\r\n      is_won\r\n      votes\r\n      constituency {\r\n        year\r\n        candidates {\r\n          person_id\r\n          votes\r\n        }\r\n      }\r\n    }\r\n    councillors { # to get the tags for the councilors\r\n      year\r\n      constituency {\r\n        code\r\n      }\r\n    } \r\n  }\r\n  vote_percentage\r\n  votes\r\n  is_won\r\n}\r\n`\r\n\r\nexport const QUERY_CONSTITUENCIES = gql`\r\nquery($year: Int!, $code: String!) {\r\n  dcd_constituencies(where: { year: { _eq: $year }, code: { _eq: $code } }) {\r\n    ${CONSTITUENCIES_DATA}\r\n    predecessors {\r\n      intersect_area\r\n      predecessor {\r\n        ${CONSTITUENCIES_DATA}\r\n      }\r\n    }\r\n  }  \r\n}\r\n`\r\n\r\nexport const QUERY_CONSTITUENCY_STATS = gql`\r\n  query($year: Int!, $code: String!) {\r\n    dcd_constituencies(where: { year: { _eq: $year }, code: { _eq: $code } }) {\r\n      vote_stats {\r\n        count\r\n        type\r\n        subtype\r\n        category_1\r\n        category_2\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const QUERY_GET_AREA = gql`\r\n  query {\r\n    dcd_districts {\r\n      dc_code\r\n      dc_name_zh\r\n      constituencies(where: { year: { _eq: 2019 } }) {\r\n        code\r\n        name_zh\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const QUERY_GET_PERSON_ELECTIONS = gql`\r\n  query get_person_elections($person_id: Int!) {\r\n    dcd_people_by_pk(id: $person_id) {\r\n      candidates(order_by: { year: desc }) {\r\n        year\r\n        constituency {\r\n          name_zh\r\n          code\r\n        }\r\n        camp\r\n        political_affiliation\r\n        votes\r\n        is_won\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const QUERY_GET_PERSON_MEETING_ATTENDANCES = gql`\r\n  query get_meeting_attendance($person_id: Int!) {\r\n    dcd_councillors(where: { person: { id: { _eq: $person_id } } }) {\r\n      year\r\n      cacode\r\n      term_from\r\n      term_to\r\n      career\r\n      district {\r\n        dc_name_zh\r\n      }\r\n      political_affiliation\r\n      post\r\n      constituency {\r\n        id\r\n        name_zh\r\n      }\r\n      meeting_attendances(\r\n        order_by: { meeting: { meet_year: desc }, total: desc }\r\n      ) {\r\n        meeting {\r\n          meet_name\r\n          meet_type\r\n          meet_year\r\n        }\r\n        attended\r\n        total\r\n      }\r\n    }\r\n  }\r\n`\r\n","import React from 'react'\r\nimport { Typography, Button } from '@material-ui/core'\r\nimport styled from 'styled-components'\r\nimport {\r\n  ExpansionPanel,\r\n  ExpansionPanelSummary,\r\n  ExpansionPanelDetails,\r\n} from '@material-ui/core'\r\nimport { DRAWER_CLOSE } from 'reducers/drawer'\r\nimport ContextStore from 'ContextStore'\r\nimport { withRouter } from 'react-router-dom'\r\nimport { Query } from 'react-apollo'\r\nimport { QUERY_GET_AREA } from 'queries/gql'\r\n\r\nconst Container = styled.div`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n`\r\n\r\nconst DistrictContainer = styled(Button)`\r\n  && {\r\n    width: 120px;\r\n    justify-content: left;\r\n  }\r\n`\r\n\r\nconst DistrictSelector = props => {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n  const renderDCCA = district => {\r\n    return (\r\n      <div>\r\n        {district.constituencies.map(c => {\r\n          return (\r\n            <DistrictContainer\r\n              key={c.code}\r\n              onClick={() => {\r\n                dispatch({ type: DRAWER_CLOSE })\r\n                props.history.push(`/district/2019/${c.code}`)\r\n              }}\r\n              color=\"secondary\"\r\n            >\r\n              <Typography variant=\"h6\">{c.name_zh}</Typography>\r\n            </DistrictContainer>\r\n          )\r\n        })}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Query query={QUERY_GET_AREA}>\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n\r\n          return (\r\n            <>\r\n              {data.dcd_districts.map(d => (\r\n                <ExpansionPanel key={d.dc_code}>\r\n                  <ExpansionPanelSummary\r\n                    aria-controls=\"panel1a-content\"\r\n                    id=\"panel1a-header\"\r\n                  >\r\n                    <Typography>{d.dc_name_zh}</Typography>\r\n                  </ExpansionPanelSummary>\r\n                  <ExpansionPanelDetails>{renderDCCA(d)}</ExpansionPanelDetails>\r\n                </ExpansionPanel>\r\n              ))}\r\n            </>\r\n          )\r\n        }}\r\n      </Query>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default withRouter(DistrictSelector)\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport AddressSearcher from './AddressSearcher'\r\nimport DistrictSelector from './DistrictSelector'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Button from '@material-ui/core/Button'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { withRouter } from 'react-router-dom'\r\nimport ContextStore from 'ContextStore'\r\nimport { DRAWER_CLOSE } from 'reducers/drawer'\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    background-color: #ececec;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst Container = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst ExpandedRow = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nconst ContentRowContainer = styled(ExpandedRow)`\r\n  && {\r\n    flex-flow: column;\r\n  }\r\n`\r\n\r\nconst AddressSearchContainer = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    padding: 21px 16px 21px 16px;\r\n    background-color: ${props => props.theme.secondaryBackgroundColor};\r\n  }\r\n`\r\n\r\nconst TabContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    width: 100%;\r\n    justify-content: center;\r\n  }\r\n`\r\n\r\nconst TabButton = styled(Button)`\r\n  && {\r\n    margin: 10px 10px 0px 10px;\r\n    padding-bottom: 15px;\r\n\r\n    color: ${props =>\r\n      props.active === 'active'\r\n        ? props.theme.subtextColor\r\n        : props.theme.main.color};\r\n    border-bottom: ${props =>\r\n      props.active === 'active'\r\n        ? `1px solid ${props.theme.subtextColor}`\r\n        : 'none'};\r\n  }\r\n`\r\n\r\nconst NavBarButton = styled(IconButton)`\r\n  && {\r\n    position: fixed;\r\n    top: 0px;\r\n    right: 0px;\r\n  }\r\n`\r\n\r\nfunction SearchPage(props) {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n  const [selectedTab, setSelectedTab] = React.useState(\r\n    props.selectedTab || 'district'\r\n  )\r\n  function handleAddressSelected(result) {\r\n    /* TODO: \r\n      Use context (?) to store the Global district result array\r\n      When user select click previous button in district page, \r\n      the CACODE should follow follow the above result\r\n    */\r\n\r\n    props.history.push(`/district/${result.year}/${result.code}`)\r\n    dispatch({ type: DRAWER_CLOSE })\r\n  }\r\n\r\n  function onTabSelected(tab) {\r\n    return () => {\r\n      setSelectedTab(tab)\r\n    }\r\n  }\r\n\r\n  function renderSearchDistrict() {\r\n    return (\r\n      <ContentRowContainer>\r\n        <AddressSearchContainer>\r\n          <AddressSearcher handleAddressSelected={handleAddressSelected} />\r\n        </AddressSearchContainer>\r\n        <DistrictSelector />\r\n      </ContentRowContainer>\r\n    )\r\n  }\r\n\r\n  function renderSearchPeople() {\r\n    return <ContentRowContainer></ContentRowContainer>\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <NavBarButton\r\n        color=\"inherit\"\r\n        component=\"span\"\r\n        aria-label=\"Menu\"\r\n        onClick={() => {\r\n          dispatch({ type: DRAWER_CLOSE })\r\n        }}\r\n      >\r\n        <CloseIcon fontSize=\"small\" />\r\n      </NavBarButton>\r\n      <TabContainer>\r\n        <TabButton\r\n          active={selectedTab === 'district' ? 'active' : 'inactive'}\r\n          onClick={onTabSelected('district')}\r\n        >\r\n          <Typography variant=\"h3\">找選區</Typography>\r\n        </TabButton>\r\n        <TabButton\r\n          active={selectedTab === 'people' ? 'active' : 'inactive'}\r\n          onClick={onTabSelected('people')}\r\n        >\r\n          <Typography variant=\"h3\">找候選人</Typography>\r\n        </TabButton>\r\n      </TabContainer>\r\n      <StyledDivier />\r\n      {selectedTab === 'district'\r\n        ? renderSearchDistrict()\r\n        : renderSearchPeople()}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default withRouter(SearchPage)\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index, ...other } = props\r\n\r\n  return (\r\n    <Typography\r\n      component=\"div\"\r\n      role=\"tabpanel\"\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      <>{children}</>\r\n    </Typography>\r\n  )\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  titles: PropTypes.array,\r\n}\r\n\r\nexport default function ScrollableTabsButtonAuto(props) {\r\n  const [selectedTab, setSelectedTab] = React.useState(0)\r\n  const { titles, children } = props\r\n\r\n  // Get all the me\r\n  // const allMeetings = _.flatten(\r\n  //   person.councillors.map(c => c.meeting_attendances)\r\n  // )\r\n  function handleChange(event, newValue) {\r\n    setSelectedTab(newValue)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <AppBar position=\"static\">\r\n        <Tabs value={selectedTab} onChange={handleChange}>\r\n          {titles.map((title, index) => (\r\n            <Tab\r\n              label={title}\r\n              id={`scrollable-auto-tab-${index}`}\r\n              key={index}\r\n              aria-controls={`scrollable-auto-tabpanel-${index}`}\r\n            />\r\n          ))}\r\n        </Tabs>\r\n      </AppBar>\r\n      {// TODO: support single tab\r\n      children &&\r\n        children.length > 0 &&\r\n        children.map((child, index) => (\r\n          <TabPanel key={index} hidden={selectedTab !== index}>\r\n            {child}\r\n          </TabPanel>\r\n        ))}\r\n    </>\r\n  )\r\n}\r\n","export const getTagsForPerson = person => {\r\n  const tags = []\r\n  if (!person.candidates && !person.councillors) {\r\n    return tags\r\n  }\r\n  // TODO: remove this if he is not attending the 2019 election\r\n  const attending2019Election = true\r\n\r\n  if (person.councillors) {\r\n    const current = person.councillors.find(c => c.year === 2015)\r\n    if (current && attending2019Election) {\r\n      tags.push('競逐連任')\r\n    }\r\n  }\r\n\r\n  if (person.candidates) {\r\n    const sortedElections = person.candidates.sort((a, b) => b.year - a.year)\r\n    if (attending2019Election) {\r\n      tags.push(`曾參選${sortedElections.length}屆`)\r\n    }\r\n\r\n    let electedCount = 0\r\n    for (let i = 0; i < sortedElections.length; i++) {\r\n      const { is_won } = sortedElections[i]\r\n      if (!is_won) {\r\n        break\r\n      }\r\n      electedCount++\r\n    }\r\n\r\n    if (electedCount > 1) {\r\n      tags.push(`連任${electedCount}屆`)\r\n    }\r\n\r\n    const lastElection = sortedElections[0]\r\n\r\n    if (lastElection.constituency.candidates.length === 1) {\r\n      tags.push(`自動當選`)\r\n    }\r\n\r\n    if (lastElection.constituency.year === 2015) {\r\n      const myVotes = lastElection.constituency.candidates.find(\r\n        c => c.person_id === person.id\r\n      ).votes\r\n      const highestVotes = lastElection.constituency.candidates\r\n        .filter(c => c.person_id !== person.id)\r\n        .map(c => c.votes)\r\n        .reduce((c, v) => Math.max(c, v), 0)\r\n\r\n      const diff = myVotes - highestVotes\r\n      if (diff > 0) {\r\n        // win\r\n        if (diff <= 50 && highestVotes > 1000) {\r\n          tags.push(`險勝${diff}票`)\r\n        } else {\r\n          tags.push(`贏${diff}票`)\r\n        }\r\n      } else if (diff < 0) {\r\n        // lose\r\n        tags.push(`輸${-diff}票`)\r\n      }\r\n    }\r\n  }\r\n\r\n  return tags\r\n}\r\n\r\nexport const getElectionResults = person => {\r\n  const result = {}\r\n  if (!person.candidates && !person.councillors) {\r\n    return result\r\n  }\r\n\r\n  if (person.candidates) {\r\n    const sortedElections = person.candidates.sort((a, b) => b.year - a.year)\r\n    result.lastParticipatedYear = sortedElections[0].year\r\n    result.participationCount = sortedElections.length\r\n\r\n    let relectedCount = 0\r\n    for (let i = 0; i < sortedElections.length; i++) {\r\n      const { is_won } = sortedElections[i]\r\n      if (!is_won) {\r\n        break\r\n      }\r\n      relectedCount++\r\n    }\r\n\r\n    result.relectedCount = relectedCount - 1\r\n\r\n    sortedElections.forEach(election => {\r\n      const year = election.constituency.year\r\n      const yearResult = {}\r\n\r\n      yearResult.uncontested =\r\n        election.constituency.candidates.length === 1 ? true : false\r\n\r\n      const myVotes = election.constituency.candidates.find(\r\n        c => c.person_id === person.id\r\n      ).votes\r\n      const highestVotes = election.constituency.candidates\r\n        .filter(c => c.person_id !== person.id)\r\n        .map(c => c.votes)\r\n        .reduce((c, v) => Math.max(c, v), 0)\r\n\r\n      yearResult.votes = myVotes\r\n      yearResult.diff = myVotes - highestVotes\r\n\r\n      result[year] = yearResult\r\n    })\r\n  }\r\n\r\n  return result\r\n}\r\n\r\nexport const getColorFromCamp = camp => {\r\n  if (!camp) return 'uncertain'\r\n  const mapping = {\r\n    泛民: 'democracy',\r\n    建制: 'establishment',\r\n    本土: 'localist',\r\n    傘兵: 'localist',\r\n    自決: 'localist',\r\n    其他: 'other',\r\n    不明: 'uncertain',\r\n  }\r\n\r\n  return mapping[camp] || 'uncertain'\r\n}\r\n\r\nexport const getColorFromPoliticalAffiliation = pa => {\r\n  if (!pa) return 'uncertain'\r\n\r\n  const mapping = {\r\n    democracy: [\r\n      '民主黨',\r\n      '公民黨',\r\n      '香港民主民生協進會',\r\n      '民協',\r\n      '社會民主連線',\r\n      '支聯會',\r\n      '民主動力',\r\n      '街坊工友服務處',\r\n      '街工',\r\n      '工黨',\r\n      '職工盟',\r\n      '新民主同盟',\r\n      '香港本土',\r\n      '獨立民主派',\r\n    ],\r\n    establishment: [\r\n      '民主建港協進聯盟',\r\n      '民建聯',\r\n      '新界社團聯會',\r\n      '新社聯',\r\n      '香港工會聯合會',\r\n      '工聯會',\r\n      '港九勞工社團聯會',\r\n      '香港經濟民生聯盟',\r\n      '西九新動力',\r\n      '自由黨',\r\n      '新民黨',\r\n      '新世紀論壇',\r\n    ],\r\n    localist: [\r\n      '香港眾志',\r\n      '青年新政',\r\n      '本土民主前線',\r\n      '東九龍社區關注組',\r\n      '天水圍民生關注平台',\r\n      '慈雲山建設力量',\r\n      '屯門社區關注組',\r\n      '長沙灣社區發展力量',\r\n      '社區網絡聯盟',\r\n      '沙田社區網絡',\r\n      '荃灣社區網絡',\r\n      '天水圍社區發展網絡',\r\n      '屯門社區網絡',\r\n      '葵青連結動力',\r\n      '藍田社區網絡',\r\n      '埔向晴天',\r\n      '荃灣民生動力',\r\n      '北區動源',\r\n      '維多利亞社區協會',\r\n    ],\r\n    other: ['民主思路', '新思維'],\r\n  }\r\n\r\n  for (let camp of Object.keys(mapping)) {\r\n    for (let party of mapping[camp]) {\r\n      if (pa.includes(party)) {\r\n        return camp\r\n      }\r\n    }\r\n  }\r\n\r\n  return 'uncertain'\r\n}\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport styled from 'styled-components'\r\n\r\nconst MobileTableCell = styled(TableCell)`\r\n  && {\r\n    padding: 8px 10px;\r\n  }\r\n`\r\n\r\nconst CouncillorMeetingAttendace = props => {\r\n  const { meetings } = props\r\n\r\n  return (\r\n    <Table>\r\n      <TableHead>\r\n        <TableRow>\r\n          <MobileTableCell align=\"left\">會議</MobileTableCell>\r\n          <MobileTableCell align=\"left\">性質</MobileTableCell>\r\n          <MobileTableCell align=\"left\">年份</MobileTableCell>\r\n          <MobileTableCell align=\"left\">與席</MobileTableCell>\r\n        </TableRow>\r\n      </TableHead>\r\n      <TableBody>\r\n        {meetings.map((m, index) => (\r\n          <TableRow key={index}>\r\n            <MobileTableCell component=\"th\" scope=\"row\">\r\n              {m.meeting.meet_name}\r\n            </MobileTableCell>\r\n            <MobileTableCell align=\"left\">\r\n              {m.meeting.meet_type}\r\n            </MobileTableCell>\r\n            <MobileTableCell align=\"left\">\r\n              {m.meeting.meet_year}\r\n            </MobileTableCell>\r\n            <MobileTableCell align=\"left\">\r\n              {m.attended}/{m.total}\r\n            </MobileTableCell>\r\n          </TableRow>\r\n        ))}\r\n      </TableBody>\r\n    </Table>\r\n  )\r\n}\r\n\r\nCouncillorMeetingAttendace.propsType = {\r\n  meetings: PropTypes.array,\r\n}\r\n\r\nexport default CouncillorMeetingAttendace\r\n","import React from 'react'\r\nimport { Query } from 'react-apollo'\r\nimport { QUERY_GET_PERSON_MEETING_ATTENDANCES } from 'queries/gql'\r\nimport PropTypes from 'prop-types'\r\nimport CouncillorMeetingAttendace from 'components/templates/CouncillorMeetingAttendance'\r\nimport _ from 'lodash'\r\n\r\nconst CouncillorMeetingAttendaceContainer = props => {\r\n  const { personId } = props\r\n  return (\r\n    <Query\r\n      query={QUERY_GET_PERSON_MEETING_ATTENDANCES}\r\n      variables={{ person_id: personId }}\r\n    >\r\n      {({ loading, error, data }) => {\r\n        if (loading) return null\r\n        if (error) return `Error! ${error}`\r\n\r\n        const meetings = _.flatten(\r\n          data.dcd_councillors.map(c => c.meeting_attendances)\r\n        )\r\n        return (\r\n          <>\r\n            <CouncillorMeetingAttendace meetings={meetings} />\r\n          </>\r\n        )\r\n      }}\r\n    </Query>\r\n  )\r\n}\r\n\r\nCouncillorMeetingAttendaceContainer.propsType = {\r\n  personId: PropTypes.int,\r\n}\r\nexport default CouncillorMeetingAttendaceContainer\r\n","import styled from 'styled-components'\r\nimport Card from '@material-ui/core/Card'\r\nimport React from 'react'\r\n\r\nconst StyledCard = styled(Card)`\r\n  && {\r\n    padding: 16px;\r\n    margin: 16px;\r\n    background-color: #fafafa;\r\n  }\r\n`\r\n\r\nexport const PlainCard = props => {\r\n  return <StyledCard {...props}>{props.children}</StyledCard>\r\n}\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { PlainCard } from 'components/molecules/Card'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { Box, Grid } from '@material-ui/core'\r\n\r\nconst PersonElectionHistories = props => {\r\n  const { histories } = props\r\n\r\n  return (\r\n    <>\r\n      {histories.map((m, index) => (\r\n        <PlainCard key={index}>\r\n          <Box>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              {m.year}\r\n            </Typography>\r\n          </Box>\r\n          <Grid container>\r\n            <Grid item xs={4}>\r\n              <Typography variant=\"h5\">{m.constituency.name_zh}</Typography>\r\n            </Grid>\r\n            <Grid item xs={5}>\r\n              <Typography variant=\"h5\">{`${m.political_affiliation || '-'}（${\r\n                m.camp\r\n              }）`}</Typography>\r\n            </Grid>\r\n            {m.votes > 0 ? (\r\n              <Grid item xs={3}>\r\n                <Typography variant=\"h5\">{`${m.votes}票`}</Typography>\r\n              </Grid>\r\n            ) : (\r\n              <Grid item xs={3}>\r\n                <Typography variant=\"h5\">自動當選</Typography>\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n          <Grid container>\r\n            <Grid item xs={4}>\r\n              <Typography variant=\"h6\">{m.constituency.code}</Typography>\r\n            </Grid>\r\n            <Grid item xs={5}>\r\n              <Typography variant=\"h6\">報稱政治聯繫</Typography>\r\n            </Grid>\r\n            {m.votes > 0 ? (\r\n              <Grid item xs={3}>\r\n                <Typography variant=\"h6\">\r\n                  {m.is_won ? '當選' : '落敗'}\r\n                </Typography>\r\n              </Grid>\r\n            ) : (\r\n              <Grid item xs={3}></Grid>\r\n            )}\r\n          </Grid>\r\n        </PlainCard>\r\n      ))}\r\n    </>\r\n  )\r\n}\r\n\r\nPersonElectionHistories.propsType = {\r\n  histories: PropTypes.array,\r\n}\r\n\r\nexport default PersonElectionHistories\r\n","import React from 'react'\r\nimport { Query } from 'react-apollo'\r\nimport { QUERY_GET_PERSON_ELECTIONS } from 'queries/gql'\r\nimport PropTypes from 'prop-types'\r\nimport PersonElectionHistories from 'components/templates/PersonElectionHistories'\r\n\r\nconst PersonElectionHistoriesContainer = props => {\r\n  const { personId } = props\r\n  return (\r\n    <Query\r\n      query={QUERY_GET_PERSON_ELECTIONS}\r\n      variables={{ person_id: personId }}\r\n    >\r\n      {({ loading, error, data }) => {\r\n        if (loading) return null\r\n        if (error) return `Error! ${error}`\r\n\r\n        return (\r\n          <>\r\n            <PersonElectionHistories\r\n              histories={data.dcd_people_by_pk.candidates}\r\n            />\r\n          </>\r\n        )\r\n      }}\r\n    </Query>\r\n  )\r\n}\r\n\r\nPersonElectionHistoriesContainer.propsType = {\r\n  personId: PropTypes.int,\r\n}\r\nexport default PersonElectionHistoriesContainer\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ScrollableTabs from 'components/organisms/ScrollableTabs'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport { getColorFromCamp } from 'utils/helper'\r\nimport CouncillorMeetingAttendanceContainer from 'components/containers/CouncillorMeetingAttendanceContainer'\r\nimport PersonElectionHistoriesContainer from 'components/containers/PersonElectionHistoriesContainer'\r\n\r\n// TODO: add age, camp & political_affiliation\r\nconst GET_PEOPLE_PROFILE = gql`\r\n  query($uuid: uuid!) {\r\n    dcd_people(where: { uuid: { _eq: $uuid } }) {\r\n      id\r\n      uuid\r\n      name_zh\r\n      name_en\r\n      gender\r\n      estimated_yob\r\n      councillors {\r\n        year\r\n        cacode\r\n        term_from\r\n        term_to\r\n        career\r\n        district {\r\n          dc_name_zh\r\n        }\r\n        political_affiliation\r\n        post\r\n        constituency {\r\n          id\r\n          name_zh\r\n        }\r\n      }\r\n      candidates {\r\n        candidate_number\r\n        is_won\r\n        occupation\r\n        political_affiliation\r\n        age\r\n        cacode\r\n        camp\r\n        election_type\r\n        year\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst CandidateHeaderContainer = styled(FlexRowContainer)`\r\n  && {\r\n    height: 116px;\r\n    position: relative;\r\n    display: flex;\r\n    background: linear-gradient(\r\n      ${props => props.theme.camp[props.camp]} 84px,\r\n      rgba(255, 255, 255, 0) 32px\r\n    );\r\n  }\r\n`\r\n\r\nconst CandidateAvatar = styled(Avatar)`\r\n  && {\r\n    position: absolute;\r\n    left: 16px;\r\n    bottom: 8px;\r\n    width: 84px;\r\n    height: 84px;\r\n  }\r\n`\r\n\r\nconst PersonName = styled.div`\r\n  && {\r\n    position: absolute;\r\n    left: 116px;\r\n    top: 32px;\r\n  }\r\n`\r\n\r\nconst YearDiv = styled.div`\r\n  && {\r\n    font-size: 24px;\r\n    font-weight: 600;\r\n    color: #9b9b9b;\r\n    margin-bottom: 20px;\r\n  }\r\n`\r\n\r\nconst PersonHighlight = styled.div`\r\n  && {\r\n    display: flex;\r\n  }\r\n`\r\nconst ElectionHistoryPaper = styled(Paper)`\r\n  && {\r\n    padding: 20px;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentGrid = styled(Grid)`\r\n  && {\r\n    padding: 15px;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentSpan = styled(Grid)`\r\n  && {\r\n    font-size: 18px;\r\n    color: #4a4a4a;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentHeaderSpan = styled(ElectionHistoryContentSpan)`\r\n  && {\r\n    font-weight: 500;\r\n  }\r\n`\r\nconst ElectionDetailButton = styled.div`\r\n  && {\r\n    padding: 15px;\r\n    font-weight: 600;\r\n    color: #ffb700;\r\n    width: 100%;\r\n    text-align: center;\r\n    border-radius: 4px;\r\n    border: 2px solid #ffb700;\r\n    cursor: pointer;\r\n  }\r\n`\r\n\r\nclass ProfilePage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  async componentDidMount() {}\r\n\r\n  handleElectionDetailButton = (year, code) => {\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  renderElectionInfoCard(election, yob) {\r\n    return (\r\n      <Grid item xs={12} md={4}>\r\n        <YearDiv>{`${election.year}年`}</YearDiv>\r\n        <ElectionHistoryPaper>\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              地區\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {' '}\r\n              {election.constituency && election.constituency.name\r\n                ? election.constituency.name\r\n                : '-'}{' '}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              選區\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {`${election.constituency.name_zh} （${election.cacode}）`}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              陣營\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {election.camp ? election.camp : '-'}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              得票率\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {`${election.vote_percentage}% （${\r\n                election.is_won ? '當選' : '落敗'\r\n              }）`}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionDetailButton\r\n              onClick={() => {\r\n                this.handleElectionDetailButton(election.year, election.cacode)\r\n              }}\r\n            >\r\n              查看選舉資料\r\n            </ElectionDetailButton>\r\n          </ElectionHistoryContentGrid>\r\n        </ElectionHistoryPaper>\r\n      </Grid>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      match: {\r\n        params: { uuid },\r\n      },\r\n    } = this.props\r\n\r\n    // todo: use ENV_VAR\r\n    const homeUrl = 'https://cswbrian.github.io/district-councils-dashboard/'\r\n\r\n    return (\r\n      <Query query={GET_PEOPLE_PROFILE} variables={{ uuid }}>\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n          const person = data.dcd_people[0]\r\n\r\n          const currentTerm =\r\n            person.councillors &&\r\n            person.councillors[person.councillors.length - 1]\r\n          const lastElection =\r\n            person.candidates && person.candidates[person.candidates.length - 1]\r\n\r\n          const personHighlight = []\r\n\r\n          if (person.estimated_yob) {\r\n            personHighlight.push({\r\n              title: '年齡',\r\n              text: `${2019 - person.estimated_yob}歲`,\r\n            })\r\n          }\r\n\r\n          if (currentTerm && currentTerm.political_affiliation) {\r\n            personHighlight.push({\r\n              title: '報稱政治聯繫',\r\n              text: `${currentTerm.political_affiliation}`,\r\n            })\r\n          } else if (lastElection && lastElection.political_affiliation) {\r\n            personHighlight.push({\r\n              title: '報稱政治聯繫',\r\n              text:\r\n                `${lastElection.political_affiliation}` +\r\n                (lastElection.camp && `（${lastElection.camp}）`),\r\n            })\r\n          }\r\n\r\n          personHighlight.push({\r\n            title: '職業',\r\n            text:\r\n              (currentTerm && currentTerm.career) || lastElection.occupation,\r\n          })\r\n\r\n          return (\r\n            <>\r\n              <CandidateHeaderContainer\r\n                camp={getColorFromCamp(lastElection.camp)}\r\n              >\r\n                <Box>\r\n                  <CandidateAvatar\r\n                    src={`${homeUrl}/static/images/avatar/${person.uuid}.jpg`}\r\n                    imgProps={{\r\n                      onError: e => {\r\n                        e.target.src = `${homeUrl}/static/images/avatar/default.png`\r\n                      },\r\n                    }}\r\n                  />\r\n                </Box>\r\n                <Box>\r\n                  <PersonName>\r\n                    <Typography\r\n                      variant=\"h3\"\r\n                      style={{ marginBottom: '2px', color: 'white' }}\r\n                    >\r\n                      {person.name_zh || ''}\r\n                    </Typography>\r\n                    <Typography\r\n                      variant=\"h5\"\r\n                      style={{ marginBottom: '8px', color: 'white' }}\r\n                    >\r\n                      {person.name_en || ''}\r\n                    </Typography>\r\n                    {currentTerm &&\r\n                      currentTerm.term_to &&\r\n                      Date.parse(new Date()) <\r\n                        Date.parse(currentTerm.term_to) && (\r\n                        <Typography\r\n                          variant=\"h6\"\r\n                          color=\"secondary\"\r\n                        >{`現任${currentTerm.district.dc_name_zh}區議員（${currentTerm.constituency.name_zh}）`}</Typography>\r\n                      )}\r\n                  </PersonName>\r\n                </Box>\r\n              </CandidateHeaderContainer>\r\n\r\n              <PersonHighlight>\r\n                {personHighlight.map((highlight, index) => (\r\n                  <Box key={index} p={2}>\r\n                    <Typography variant=\"h5\">{highlight.text}</Typography>\r\n                    <Typography variant=\"h6\">{highlight.title}</Typography>\r\n                  </Box>\r\n                ))}\r\n              </PersonHighlight>\r\n              <ScrollableTabs titles={['參選紀錄', '會議出席率']}>\r\n                <PersonElectionHistoriesContainer personId={person.id} />\r\n                <CouncillorMeetingAttendanceContainer personId={person.id} />\r\n              </ScrollableTabs>\r\n            </>\r\n          )\r\n        }}\r\n      </Query>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ProfilePage\r\n","import React, { Component } from 'react'\r\nimport Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport VectorSource from 'ol/source/Vector'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport { Style, Stroke, Fill, Text } from 'ol/style'\r\nimport Select from 'ol/interaction/Select'\r\nimport styled from 'styled-components'\r\n\r\nimport dc2003 from '../data/DCCA_2003'\r\nimport dc2007 from '../data/DCCA_2007'\r\nimport dc2011 from '../data/DCCA_2011'\r\nimport dc2015 from '../data/DCCA_2015'\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nconst MapContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst regionStyle = new Style({\r\n  fill: new Fill({\r\n    color: 'rgba(255, 255, 255, 0.2)',\r\n  }),\r\n  stroke: new Stroke({\r\n    color: '#319FD3',\r\n    width: 1,\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#fff',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nconst highlightStyle = new Style({\r\n  stroke: new Stroke({\r\n    color: '#f00',\r\n    width: 1,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(255,0,0,0.1)',\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#f00',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nclass OLMap extends Component {\r\n  featureOverlay\r\n  highlightedFeature\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { year, code } = this.props\r\n    const dc = [dc2003, dc2007, dc2011, dc2015, dc2019].find(\r\n      d => d.name === `DCCA_${year}`\r\n    )\r\n    let isDCDataExist = dc ? true : false\r\n    let featuresLayer\r\n\r\n    if (isDCDataExist) {\r\n      this.featureSource = new VectorSource({\r\n        features: new GeoJSON().readFeatures(dc),\r\n      })\r\n\r\n      featuresLayer = new VectorLayer({\r\n        source: this.featureSource,\r\n        style: feature => {\r\n          regionStyle.getText().setText(feature.getProperties().CNAME)\r\n          return regionStyle\r\n        },\r\n      })\r\n    }\r\n\r\n    // create map object with feature layer\r\n    const layers = [\r\n      //default OSM layer\r\n      new TileLayer({\r\n        source: new XYZ({\r\n          url:\r\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\r\n        }),\r\n      }),\r\n    ]\r\n\r\n    if (isDCDataExist) {\r\n      layers.push(featuresLayer)\r\n    }\r\n\r\n    const map = new Map({\r\n      target: this.refs.mapContainer,\r\n      layers,\r\n      view: new View({\r\n        projection: 'EPSG:4326',\r\n        center: [114.2029, 22.3844],\r\n        zoom: 13,\r\n      }),\r\n    })\r\n\r\n    this.featureOverlay = new VectorLayer({\r\n      source: new VectorSource(),\r\n      map: map,\r\n      style: function(feature) {\r\n        highlightStyle.getText().setText(`${feature.getProperties().CNAME}`)\r\n        return highlightStyle\r\n      },\r\n    })\r\n\r\n    if (isDCDataExist) {\r\n      // Fit to feature\r\n      const features = this.featureSource.getFeatures()\r\n      for (let i = 0; i < features.length; i++) {\r\n        if (features[i].getProperties().CACODE === code) {\r\n          const extent = features[i].getGeometry().getExtent()\r\n          map.getView().fit(extent, {\r\n            size: map.getSize(),\r\n            padding: [10, 10, 10, 10],\r\n          })\r\n\r\n          this.highlightFeature(features[i])\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      map,\r\n      view: map.getView(),\r\n      featuresLayer: isDCDataExist ? featuresLayer : null,\r\n    })\r\n\r\n    const select = new Select()\r\n\r\n    if (select !== null) {\r\n      map.addInteraction(select)\r\n      select.on('select', this.handleMapClick)\r\n    }\r\n  }\r\n\r\n  highlightFeature(feature) {\r\n    if (this.highlightedFeature) {\r\n      this.featureOverlay.getSource().removeFeature(this.highlightedFeature)\r\n    }\r\n\r\n    this.featureOverlay.getSource().addFeature(feature)\r\n    this.highlightedFeature = feature\r\n  }\r\n\r\n  handleMapClick = e => {\r\n    const { year, changeDistrict } = this.props\r\n    const selectedFeature = e.target.getFeatures().item(0)\r\n\r\n    if (selectedFeature) {\r\n      this.highlightFeature(selectedFeature)\r\n      changeDistrict(year, selectedFeature.get('CACODE'))\r\n      this.state.map.getView().fit(selectedFeature.getGeometry().getExtent(), {\r\n        duration: 200,\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <MapContainer ref=\"mapContainer\"> </MapContainer>\r\n  }\r\n}\r\n\r\nexport default OLMap\r\n","import createBreakpoints from '@material-ui/core/styles/createBreakpoints'\r\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme'\r\n\r\nexport const bps = createBreakpoints({})\r\n\r\nexport const headingFontFamily = 'Source Serif Pro, sans-serif'\r\nexport const bodyFontFamily = 'PT Serif, sans-serif'\r\n\r\nexport const fontFamily = ['PingFangTC-Semibold', 'PingFangTC-Medium']\r\n\r\nexport const typography = {}\r\n\r\nexport const theme = createMuiTheme()\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\nimport { bps } from 'ui/responsive'\r\n\r\nconst Container = styled(Paper)`\r\n  && {\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f6f6f6;\r\n    padding: 0;\r\n\r\n    ${bps.down('md')} {\r\n      width: 100%;\r\n    }\r\n  }\r\n`\r\n\r\nconst InnerContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    align-items: baseline;\r\n    padding-left: 32px;\r\n    padding-right: 32px;\r\n  }\r\n`\r\n\r\nconst YearText = styled(Typography)`\r\n  && {\r\n    font-family: Avenir;\r\n    font-size: 30px;\r\n    font-weight: 900;\r\n    color: #333333;\r\n  }\r\n`\r\n\r\nconst RegionText = styled(Typography)`\r\n  && {\r\n    width: 100%;\r\n    font-family: PingFangTC-Medium;\r\n    font-size: 20px;\r\n    font-weight: 500;\r\n    color: #ffb700;\r\n  }\r\n`\r\n\r\nconst CodeText = styled(Typography)`\r\n  && {\r\n    margin-left: 10px;\r\n    font-family: PingFangTC-Light;\r\n    font-size: 40px;\r\n    font-weight: 300;\r\n    color: #9b9b9b;\r\n  }\r\n`\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    margin-top: 40px;\r\n    background-color: #cecece;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst SeperatedRow = styled(Box)`\r\n  && {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    width: 100%;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n`\r\n\r\nclass DistrictCard extends Component {\r\n  static propTypes = {\r\n    year: PropTypes.number.isRequired,\r\n    code: PropTypes.string.isRequired,\r\n    name_zh: PropTypes.string.isRequired,\r\n    name_en: PropTypes.string.isRequired,\r\n    onPrevElection: PropTypes.func.isRequired,\r\n    onNextElection: PropTypes.func.isRequired,\r\n    councillors: PropTypes.array.isRequired,\r\n    district: PropTypes.object.isRequired,\r\n  }\r\n\r\n  renderPrevElectionButton(year) {\r\n    return year > 1999 ? (\r\n      <IconButton aria-label=\"arrow_back\" onClick={this.props.onPrevElection}>\r\n        <ArrowBackIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the right\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  renderNextElectionButton(year) {\r\n    const nextElectionYear = year + 4\r\n    const currentYear = new Date().getFullYear()\r\n    return nextElectionYear <= currentYear ? (\r\n      <IconButton\r\n        aria-label=\"arrow_forward\"\r\n        onClick={this.props.onNextElection}\r\n      >\r\n        <ArrowForwardIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the left\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { name_zh, year, code, councillors, district, stations } = this.props\r\n    const councillor = councillors.length > 0 ? councillors[0] : {}\r\n    return (\r\n      <Container>\r\n        <InnerContainer border={0} color=\"primary.minor\">\r\n          <SeperatedRow>\r\n            {this.renderPrevElectionButton(year)}\r\n            <YearText variant=\"button\" gutterBottom>\r\n              {year}\r\n            </YearText>\r\n            {this.renderNextElectionButton(year)}\r\n          </SeperatedRow>\r\n          <RegionText>{district.dc_name_zh}</RegionText>\r\n          <Typography variant=\"h3\">{name_zh}</Typography>\r\n          <CodeText>{code}</CodeText>\r\n          <StyledDivier />\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">區議員</Typography>\r\n            <Typography>\r\n              {councillor.person ? councillor.person.name_zh : '-'}\r\n            </Typography>\r\n          </SeperatedRow>\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">政治聯繫</Typography>\r\n            <Typography>{councillor.political_affiliation || '-'}</Typography>\r\n          </SeperatedRow>\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">投票站</Typography>\r\n            {stations.map((station, index) => (\r\n              <Typography key={index} variant=\"subtitle2\">\r\n                {station.name_zh}\r\n              </Typography>\r\n            ))}\r\n          </SeperatedRow>\r\n        </InnerContainer>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DistrictCard\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst Container = styled.div`\r\n   {\r\n    padding: 16px;\r\n  }\r\n`\r\n\r\nclass MainAreas extends Component {\r\n  static propTypes = {\r\n    areas: PropTypes.array.isRequired,\r\n  }\r\n\r\n  render() {\r\n    const { areas } = this.props\r\n    return (\r\n      <Container>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          主要屋邨 / 地區\r\n        </Typography>\r\n        <Box display=\"flex\" flexWrap=\"wrap\" alignContent=\"flex-start\">\r\n          {areas.map((area, index) => (\r\n            <Box mr={1} key={index}>\r\n              <Typography variant=\"body1\">\r\n                {`${Object.keys(area)[0]} ${area[Object.keys(area)[0]]}`}\r\n              </Typography>\r\n            </Box>\r\n          ))}\r\n        </Box>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MainAreas\r\n","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nconst Container = styled.div`\r\n  && {\r\n    padding: 16px;\r\n  }\r\n`\r\n\r\nclass CandidateList extends Component {\r\n  render() {\r\n    return (\r\n      <Container>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          候選人\r\n        </Typography>\r\n        <Typography variant=\"body1\">\r\n          2019年區議會提名期為10月2日至15日，稍後會更新潛在候選人\r\n        </Typography>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default CandidateList\r\n","import React, { Component } from 'react'\r\nimport zingchart from 'zingchart'\r\n\r\n// MUST define modulesdir for VoterTurnoutChart\r\n// https://www.zingchart.com/docs/api/modules/standard/#modules__modules_list\r\nzingchart.MODULESDIR = 'https://cdn.zingchart.com/modules/'\r\n\r\nconst chartJSON = chartData => {\r\n  const data = { male: [], female: [] }\r\n\r\n  Object.values(chartData.data).forEach(value => {\r\n    data['male'].push(value['male'])\r\n    data['female'].push(value['female'])\r\n  })\r\n\r\n  // TODO: replace this hacky code\r\n  const titles = Object.keys(chartData.data).map(\r\n    key =>\r\n      key\r\n        .split('_')\r\n        .filter(val => !isNaN(parseInt(val)))\r\n        .join('-') + '歲'\r\n  )\r\n  titles[titles.length - 1] += '及以上'\r\n  // Demo\r\n  // https://codepen.io/pen/?editors=1010\r\n\r\n  return {\r\n    type: 'bar',\r\n    stacked: true,\r\n    'stack-type': 'normal',\r\n    title: {\r\n      text: '投票人士年齡分布',\r\n      x: '40px',\r\n      y: '5px',\r\n      align: 'left',\r\n    },\r\n    subtitle: {\r\n      text: '佔全部',\r\n      x: '175px',\r\n      y: '5px',\r\n      align: 'left',\r\n      bold: false,\r\n      'font-size': '10px',\r\n      'font-color': '#7E7E7E',\r\n      'background-color': 'none',\r\n    },\r\n    plot: {\r\n      'bar-width': '25px',\r\n      'hover-state': {\r\n        visible: false,\r\n      },\r\n      animation: {\r\n        delay: 300,\r\n        sequence: 1,\r\n      },\r\n      valueBox: {\r\n        text: '%total',\r\n        rules: [\r\n          {\r\n            rule: '%stack-top == 0',\r\n            visible: 0,\r\n          },\r\n        ],\r\n        decimals: 0,\r\n      },\r\n    },\r\n    'scale-x': {\r\n      values: titles,\r\n      tick: {\r\n        visible: false,\r\n      },\r\n      guide: {\r\n        visible: false,\r\n      },\r\n      item: {\r\n        'font-color': '#8B8B8B',\r\n      },\r\n    },\r\n    'scale-y': {\r\n      short: true,\r\n      'line-color': '#7E7E7E',\r\n      tick: {\r\n        visible: false,\r\n      },\r\n      guide: {\r\n        'line-style': 'solid',\r\n      },\r\n      item: {\r\n        'font-color': '#8B8B8B',\r\n      },\r\n    },\r\n    series: [\r\n      {\r\n        values: data.male,\r\n        'background-color': '#003f5c',\r\n      },\r\n      {\r\n        values: data.female,\r\n        'background-color': '#ff6361',\r\n      },\r\n    ],\r\n    tooltip: {\r\n      visible: false,\r\n    },\r\n  }\r\n}\r\n\r\nclass VoterTurnoutChart extends Component {\r\n  componentDidMount() {\r\n    zingchart.render({\r\n      id: this.props.id,\r\n      // data: this.props.data,\r\n      data: chartJSON(this.props.data),\r\n    })\r\n  }\r\n\r\n  //Used to check the values being passed in to avoid unnecessary changes.\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //Lazy object comparison\r\n    return !(JSON.stringify(nextProps.data) === JSON.stringify(this.props.data))\r\n  }\r\n\r\n  componentWillUpdate(nextProps) {\r\n    zingchart.exec(this.props.id, 'setdata', {\r\n      data: chartJSON(nextProps.data), //nextProps.data,\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        id={this.props.id}\r\n        style={{\r\n          width: this.props.width || '100%',\r\n          height: this.props.height || '450px',\r\n        }}\r\n      ></div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default VoterTurnoutChart\r\n","import React, { Component } from 'react'\r\nimport * as d3 from 'd3'\r\n\r\n/**\r\n * Idea from https://gist.github.com/XavierGimenez/8070956\r\n */\r\n\r\nclass WaffleChart extends Component {\r\n  drawChart(data) {\r\n    var total = 0\r\n    var width,\r\n      height,\r\n      widthSquares = 20,\r\n      heightSquares = 20,\r\n      squareSize = 20,\r\n      squareValue = 0,\r\n      gap = 1,\r\n      theData = []\r\n    var color = d3.scaleOrdinal(d3.schemeCategory10)\r\n    //total\r\n\r\n    total = d3.sum(data, function(d) {\r\n      return d.population\r\n    })\r\n    //value of a square\r\n    squareValue = total / (widthSquares * heightSquares)\r\n    //remap data\r\n    data.forEach(function(d, i) {\r\n      d.population = +d.population\r\n      d.units = Math.round(d.population / squareValue)\r\n      d.percentage = Math.floor((d.population * 100) / total)\r\n      theData = theData.concat(\r\n        Array(d.units + 1)\r\n          .join(1)\r\n          .split('')\r\n          .map(function() {\r\n            return {\r\n              squareValue: squareValue,\r\n              units: d.units,\r\n              population: d.population,\r\n              percentage: d.percentage,\r\n              groupIndex: i,\r\n            }\r\n          })\r\n      )\r\n    })\r\n    width = squareSize * widthSquares + widthSquares * gap + 25\r\n    height = squareSize * heightSquares + heightSquares * gap + 25\r\n    d3.select('#waffle')\r\n      .append('svg')\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n      .append('g')\r\n      .selectAll('div')\r\n      .data(theData)\r\n      .enter()\r\n      .append('rect')\r\n      .attr('width', squareSize)\r\n      .attr('height', squareSize)\r\n      .attr('fill', function(d) {\r\n        return color(d.groupIndex)\r\n      })\r\n      .attr('y', function(d, i) {\r\n        // const row = i % heightSquares;\r\n        // return (heightSquares * squareSize) - ((row * squareSize) + (row * gap))\r\n        const row = Math.floor(i / widthSquares)\r\n        return row * squareSize + row * gap\r\n      })\r\n      .attr('x', function(d, i) {\r\n        //group n squares for column\r\n        // const col = Math.floor(i / heightSquares);\r\n        // return (col * squareSize) + (col * gap);\r\n        const col = i % widthSquares\r\n        return col * squareSize + col * gap\r\n      })\r\n      .append('title')\r\n      .text(function(d, i) {\r\n        return (\r\n          data[d.groupIndex].name +\r\n          ' | ' +\r\n          d.population +\r\n          ' , ' +\r\n          d.percentage +\r\n          '%'\r\n        )\r\n      })\r\n    //add legend with categorical data\r\n    var legend = d3\r\n      .select('#legend')\r\n      .append('svg')\r\n      .attr('width', 300)\r\n      .attr('height', 200)\r\n      .append('g')\r\n      .selectAll('div')\r\n      .data(data)\r\n      .enter()\r\n      .append('g')\r\n      .attr('transform', function(d, i) {\r\n        return 'translate(0,' + i * 20 + ')'\r\n      })\r\n    legend\r\n      .append('rect')\r\n      .attr('width', 18)\r\n      .attr('height', 18)\r\n      .style('fill', function(d, i) {\r\n        return color(i)\r\n      })\r\n    legend\r\n      .append('text')\r\n      .attr('x', 25)\r\n      .attr('y', 13)\r\n      .text(function(d) {\r\n        return d.name\r\n      })\r\n    //add value of a unit square\r\n    var legend2 = d3\r\n      .select('#legend')\r\n      .select('svg')\r\n      .append('g')\r\n      .attr('transform', 'translate(200,0)')\r\n    legend2\r\n      .append('text')\r\n      .attr('y', '14')\r\n      .attr('font-size', '18px')\r\n      .text('Total: ' + total)\r\n      .attr('fill', '#444444')\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.drawChart(this.props.data)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div id=\"waffle\"></div>\r\n\r\n        <div id=\"legend\"></div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default WaffleChart\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport PropTypes from 'prop-types'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport VoterTurnoutChart from './VoterTurnoutChart'\r\nimport WaffleChart from '../charts/WaffleChart'\r\n\r\n// TODO: change this to dcd data\r\nconst QUERY_FETCH_VOTES = gql`\r\n  query($year: Int!, $code: String!) {\r\n    dc_constituencies(where: { year: { _eq: $year }, code: { _eq: $code } }) {\r\n      candidates_aggregate {\r\n        aggregate {\r\n          sum {\r\n            votes\r\n          }\r\n        }\r\n      }\r\n      candidates {\r\n        votes\r\n        person {\r\n          name_zh\r\n          name_en\r\n        }\r\n      }\r\n      vote_stat {\r\n        total_votes\r\n        total_voters\r\n        total_voted_voters\r\n        population_excluded_foreign_worker\r\n        population_excluded_foreign_worker_lte_age_15\r\n        population_excluded_foreign_worker_lte_age_20\r\n      }\r\n      station_stats {\r\n        station_code\r\n        name_en\r\n        name_zh\r\n        votes {\r\n          votes\r\n          age\r\n          gender\r\n        }\r\n      }\r\n    }\r\n  }\r\n`\r\nconst Container = styled.div`\r\n   {\r\n    padding: 0px 15px 100px 25px;\r\n  }\r\n`\r\n\r\nconst getDataForWaffleChart = (voteStat, candidates) => {\r\n  const {\r\n    total_votes,\r\n    total_voters,\r\n    total_voted_voters,\r\n    population_excluded_foreign_worker,\r\n    population_excluded_foreign_worker_lte_age_15,\r\n    // population_excluded_foreign_worker_lte_age_20\r\n  } = voteStat\r\n\r\n  // check first the data\r\n  // TODO: the data should be good enough to remove this checking\r\n  if (\r\n    population_excluded_foreign_worker_lte_age_15 < total_voters ||\r\n    total_voters === 0 ||\r\n    total_voted_voters === 0\r\n  ) {\r\n    return []\r\n  }\r\n\r\n  const voteStats = [\r\n    {\r\n      name: '不能投票',\r\n      // population: population_excluded_foreign_worker - population_excluded_foreign_worker_lte_age_15,\r\n      population: population_excluded_foreign_worker - total_voters,\r\n    },\r\n    {\r\n      name: '沒有投票',\r\n      population:\r\n        population_excluded_foreign_worker_lte_age_15 - total_voted_voters,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    },\r\n    {\r\n      name: '投票失效',\r\n      population: total_voted_voters - total_votes,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    },\r\n  ]\r\n\r\n  candidates.forEach(({ votes, person: { name_zh, name_en } }) => {\r\n    voteStats.push({\r\n      name: `投給${name_zh || name_en}`,\r\n      population: votes,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    })\r\n  })\r\n\r\n  return voteStats\r\n}\r\n\r\nclass MainAreas extends Component {\r\n  static propTypes = {\r\n    year: PropTypes.number.isRequired,\r\n    code: PropTypes.string.isRequired,\r\n    district: PropTypes.object.isRequired,\r\n  }\r\n\r\n  render() {\r\n    const { year, code } = this.props\r\n    return (\r\n      <Query\r\n        query={QUERY_FETCH_VOTES}\r\n        variables={{ year: parseInt(year, 10), code }}\r\n      >\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n          const { candidates, vote_stat } = data.dc_constituencies[0]\r\n\r\n          let voteStats = []\r\n          if (vote_stat) {\r\n            voteStats = getDataForWaffleChart(vote_stat, candidates)\r\n          }\r\n\r\n          const stats = data.dc_constituencies[0].station_stats\r\n          const barVote = { data: {} }\r\n          barVote.total = stats.reduce((acc, cur) => {\r\n            const sub_total = cur.votes.reduce((acc, cur) => {\r\n              if (typeof barVote.data[cur.age] === 'undefined') {\r\n                barVote.data[cur.age] = {}\r\n              }\r\n              if (typeof barVote.data[cur.age][cur.gender] === 'undefined') {\r\n                barVote.data[cur.age][cur.gender] = 0\r\n              }\r\n              barVote.data[cur.age][cur.gender] += cur.votes\r\n              return acc + cur.votes\r\n            }, 0)\r\n            return acc + sub_total\r\n          }, 0)\r\n          return (\r\n            <Container>\r\n              <Typography variant=\"h4\">人口資料</Typography>\r\n              <VoterTurnoutChart\r\n                id={`${year}_${code}_voter_turnout`}\r\n                data={barVote}\r\n              />\r\n              {voteStats.length > 0 ? (\r\n                <WaffleChart\r\n                  id={`${year}_${code}_voter_treemap`}\r\n                  data={voteStats}\r\n                />\r\n              ) : (\r\n                ''\r\n              )}\r\n            </Container>\r\n          )\r\n        }}\r\n      </Query>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MainAreas\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport OLMap from '../../components/OLMap'\r\nimport { Query } from 'react-apollo'\r\nimport DistrictCard from 'components/district/DistrictCard'\r\nimport MainAreas from 'components/district/MainAreas'\r\nimport CandidateList from 'components/district/CandidateList'\r\nimport Metrics from 'components/district/Metrics'\r\nimport styled from 'styled-components'\r\nimport { bps } from 'ui/responsive'\r\n\r\nimport { QUERY_CONSTITUENCIES } from 'queries/gql'\r\n\r\nconst FullWidthBox = styled(Box)`\r\n  && {\r\n    padding-top: 4rem;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst LowerBackgroundContainer = styled(Box)`\r\n  && {\r\n    width: 100vw;\r\n    position: relative;\r\n    margin-left: -50vw;\r\n    left: 50%;\r\n    background-color: #fafafa;\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    ${bps.up('md')} {\r\n      width: 100%;\r\n    }\r\n\r\n    ${bps.up('lg')} {\r\n      width: 1440px;\r\n    }\r\n    margin: auto;\r\n  }\r\n`\r\n\r\nconst DistrictCardContainer = styled(Box)`\r\n  && {\r\n    padding-left: 30px;\r\n    margin: 0px;\r\n    width: 400px;\r\n    height: 400px;\r\n\r\n    ${bps.down('md')} {\r\n      margin: 10px;\r\n      width: 100%;\r\n      padding: 0px;\r\n    }\r\n  }\r\n`\r\n\r\nclass DistrictPage extends Component {\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //  if (this.props.route.path === nextProps.route.path) return false;\r\n    return true\r\n  }\r\n\r\n  handleCandidateSelected = person => {\r\n    this.props.history.push(\r\n      `/profile/${person.name_zh || person.name_en}/${person.uuid}`\r\n    )\r\n  }\r\n\r\n  handleChangeDistrict = (year, code) => {\r\n    if (!year || !code) return\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  onPrevElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) - 4}/${code}`)\r\n  }\r\n\r\n  onNextElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) + 4}/${code}`)\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n\r\n    return (\r\n      <>\r\n        <FlexRowContainer>\r\n          <Box\r\n            width={{ sm: '100%', md: '960px' }}\r\n            height={{ sm: '300px', md: '400px' }}\r\n          >\r\n            <OLMap\r\n              year={year}\r\n              code={code}\r\n              changeDistrict={this.handleChangeDistrict}\r\n            />\r\n          </Box>\r\n          <Query query={QUERY_CONSTITUENCIES} variables={{ year, code }}>\r\n            {({ loading, error, data }) => {\r\n              if (loading) return null\r\n              if (error) return `Error! ${error}`\r\n              const district = data.dcd_constituencies[0]\r\n              return (\r\n                <>\r\n                  <DistrictCardContainer>\r\n                    <DistrictCard\r\n                      {...district}\r\n                      year={parseInt(year, 10)}\r\n                      code={code}\r\n                      onNextElection={this.onNextElection.bind(this)}\r\n                      onPrevElection={this.onPrevElection.bind(this)}\r\n                    />\r\n                  </DistrictCardContainer>\r\n                  <FullWidthBox>\r\n                    <MainAreas areas={district.main_areas || []} />\r\n                  </FullWidthBox>\r\n                  <LowerBackgroundContainer>\r\n                    <FlexRowContainer>\r\n                      <FullWidthBox>\r\n                        <Metrics\r\n                          year={parseInt(year, 10)}\r\n                          code={code}\r\n                          district={district}\r\n                        ></Metrics>\r\n                      </FullWidthBox>\r\n                      <FullWidthBox>\r\n                        <CandidateList\r\n                          candidates={district.candidates}\r\n                          year={parseInt(year, 10)}\r\n                          code={code}\r\n                          handleCandidateSelected={this.handleCandidateSelected}\r\n                        />\r\n                      </FullWidthBox>\r\n                    </FlexRowContainer>\r\n                  </LowerBackgroundContainer>\r\n                </>\r\n              )\r\n            }}\r\n          </Query>\r\n        </FlexRowContainer>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DistrictPage\r\n","import React, { Component } from 'react'\r\nimport Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport VectorSource from 'ol/source/Vector'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport { Style, Stroke, Fill, Text } from 'ol/style'\r\nimport Select from 'ol/interaction/Select'\r\nimport styled from 'styled-components'\r\n\r\nimport dc2003 from '../data/DCCA_2003'\r\nimport dc2007 from '../data/DCCA_2007'\r\nimport dc2011 from '../data/DCCA_2011'\r\nimport dc2015 from '../data/DCCA_2015'\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nconst MapContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst regionStyle = new Style({\r\n  fill: new Fill({\r\n    color: 'rgba(255, 255, 255, 0.2)',\r\n  }),\r\n  stroke: new Stroke({\r\n    color: '#319FD3',\r\n    width: 1,\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#fff',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nconst highlightStyle = new Style({\r\n  stroke: new Stroke({\r\n    color: '#f00',\r\n    width: 1,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(255,0,0,0.1)',\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#f00',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nclass DCCACompareMap extends Component {\r\n  featureOverlay\r\n  highlightedFeature\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { year, code } = this.props\r\n    const dc = [dc2003, dc2007, dc2011, dc2015, dc2019].find(\r\n      d => d.name === `DCCA_${year}`\r\n    )\r\n    let isDCDataExist = dc ? true : false\r\n    let featuresLayer\r\n\r\n    if (isDCDataExist) {\r\n      this.featureSource = new VectorSource({\r\n        features: new GeoJSON().readFeatures(dc),\r\n      })\r\n\r\n      featuresLayer = new VectorLayer({\r\n        source: this.featureSource,\r\n        style: feature => {\r\n          regionStyle.getText().setText(feature.getProperties().CNAME)\r\n          return regionStyle\r\n        },\r\n      })\r\n    }\r\n\r\n    // create map object with feature layer\r\n    const layers = [\r\n      //default OSM layer\r\n      new TileLayer({\r\n        source: new XYZ({\r\n          url:\r\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\r\n        }),\r\n      }),\r\n    ]\r\n\r\n    if (isDCDataExist) {\r\n      layers.push(featuresLayer)\r\n    }\r\n\r\n    const map = new Map({\r\n      target: this.refs.mapContainer,\r\n      layers,\r\n      view: new View({\r\n        projection: 'EPSG:4326',\r\n        center: [114.2029, 22.3844],\r\n        zoom: 13,\r\n      }),\r\n    })\r\n\r\n    this.featureOverlay = new VectorLayer({\r\n      source: new VectorSource(),\r\n      map: map,\r\n      style: function(feature) {\r\n        highlightStyle.getText().setText(`${feature.getProperties().CNAME}`)\r\n        return highlightStyle\r\n      },\r\n    })\r\n\r\n    if (isDCDataExist) {\r\n      // Fit to feature\r\n      const features = this.featureSource.getFeatures()\r\n      for (let i = 0; i < features.length; i++) {\r\n        if (features[i].getProperties().CACODE === code) {\r\n          const extent = features[i].getGeometry().getExtent()\r\n          map.getView().fit(extent, {\r\n            size: map.getSize(),\r\n            padding: [10, 10, 10, 10],\r\n          })\r\n\r\n          this.highlightFeature(features[i])\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      map,\r\n      view: map.getView(),\r\n      featuresLayer: isDCDataExist ? featuresLayer : null,\r\n    })\r\n\r\n    const select = new Select()\r\n\r\n    if (select !== null) {\r\n      map.addInteraction(select)\r\n      select.on('select', this.handleMapClick)\r\n    }\r\n  }\r\n\r\n  highlightFeature(feature) {\r\n    if (this.highlightedFeature) {\r\n      this.featureOverlay.getSource().removeFeature(this.highlightedFeature)\r\n    }\r\n\r\n    this.featureOverlay.getSource().addFeature(feature)\r\n    this.highlightedFeature = feature\r\n  }\r\n\r\n  handleMapClick = e => {\r\n    const { year, changeDistrict } = this.props\r\n    const selectedFeature = e.target.getFeatures().item(0)\r\n\r\n    if (selectedFeature) {\r\n      this.highlightFeature(selectedFeature)\r\n      changeDistrict(year, selectedFeature.get('CACODE'))\r\n      this.state.map.getView().fit(selectedFeature.getGeometry().getExtent(), {\r\n        duration: 200,\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <MapContainer ref=\"mapContainer\"> </MapContainer>\r\n  }\r\n}\r\n\r\nexport default DCCACompareMap\r\n","import styled from 'styled-components'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport React from 'react'\r\n\r\nconst StyledChip = styled(Chip)`\r\n  && {\r\n    color: ${props => props.color};\r\n  }\r\n`\r\n\r\nexport const Tag = props => {\r\n  return (\r\n    <StyledChip\r\n      label={props.value}\r\n      variant=\"outlined\"\r\n      color=\"secondary\"\r\n      // avatar={<Avatar>MB</Avatar>}\r\n      onClick={props.handleClick}\r\n    />\r\n  )\r\n}\r\n","import styled from 'styled-components'\r\nimport { NavLink } from 'react-router-dom'\r\nimport Link from '@material-ui/core/Link'\r\n\r\nexport const UnstyledLink = styled(Link)`\r\n  text-decoration: unset;\r\n  color: unset;\r\n  font-style: unset;\r\n  cursor: pointer;\r\n`\r\n\r\nexport const UnstyledNavLink = styled(NavLink)`\r\n  text-decoration: unset;\r\n  color: unset;\r\n  font-style: unset;\r\n  cursor: pointer;\r\n`\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Box from '@material-ui/core/Box'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport { PlainCard } from '../molecules/Card'\r\nimport { Tag } from '../atoms/Tag'\r\nimport { UnstyledNavLink } from '../atoms/UnstyledLink'\r\nimport {\r\n  getColorFromPoliticalAffiliation,\r\n  getElectionResults,\r\n} from 'utils/helper'\r\n\r\nconst StyledAvatar = styled(Avatar)`\r\n  && {\r\n    margin: 10px;\r\n    width: 60px;\r\n    height: 60px;\r\n    border: 3px ${props => props.theme.camp[props.camp]} solid;\r\n  }\r\n`\r\nclass Councillor extends Component {\r\n  static propTypes = {\r\n    // areas: PropTypes.array.isRequired\r\n  }\r\n\r\n  homeUrl = 'https://cswbrian.github.io/district-councils-dashboard'\r\n\r\n  render() {\r\n    const { districts } = this.props\r\n\r\n    // Filter out small intersect area\r\n    const filteredDistricts = districts.filter(\r\n      district =>\r\n        district.intersect_area === null || district.intersect_area > 1000\r\n    )\r\n\r\n    // Reformat the councillor object\r\n    const councillors = filteredDistricts.map(district => {\r\n      const predecessor = district.predecessor\r\n      const electionResults = getElectionResults(\r\n        predecessor.councillors[0].person\r\n      )\r\n      return {\r\n        code: predecessor.code,\r\n        name_zh: predecessor.name_zh,\r\n        person: predecessor.councillors[0].person,\r\n        political_affiliation: predecessor.councillors[0].political_affiliation,\r\n        electionResults,\r\n        lastElectionResult:\r\n          electionResults[electionResults.lastParticipatedYear],\r\n      }\r\n    })\r\n\r\n    const tags = ['競逐連任'] //getTagsForPerson(councillor.person)\r\n    return (\r\n      <PlainCard>\r\n        <Typography variant=\"h6\">現任區議員</Typography>\r\n        {filteredDistricts.length > 1 && (\r\n          <Typography variant=\"h6\">{`此區與上屆${filteredDistricts.length}個選區重疊`}</Typography>\r\n        )}\r\n        {councillors.map(councillor => (\r\n          <UnstyledNavLink\r\n            key={councillor.code}\r\n            to={`/profile/${councillor.person.name_zh ||\r\n              councillor.person.name_en}/${councillor.person.uuid}`}\r\n          >\r\n            <Box>\r\n              <Box display=\"flex\">\r\n                <Box flexGrow={1}>\r\n                  <Typography variant=\"h6\" gutterBottom>\r\n                    2015{' '}\r\n                    {`${\r\n                      councillor.person.councillors.find(\r\n                        c =>\r\n                          c.year ===\r\n                          councillor.electionResults.lastParticipatedYear\r\n                      ).constituency.name_zh\r\n                    }（${\r\n                      councillor.person.councillors.find(\r\n                        c =>\r\n                          c.year ===\r\n                          councillor.electionResults.lastParticipatedYear\r\n                      ).constituency.code\r\n                    }）`}\r\n                  </Typography>\r\n                </Box>\r\n                <Box>\r\n                  {tags.length > 0 &&\r\n                    tags.map((tag, index) => <Tag value={tag} key={index} />)}\r\n                </Box>\r\n              </Box>\r\n\r\n              <Grid container wrap=\"nowrap\" spacing={0}>\r\n                <Grid item>\r\n                  <StyledAvatar\r\n                    camp={getColorFromPoliticalAffiliation(\r\n                      councillor.political_affiliation\r\n                    )}\r\n                    src={`${this.homeUrl}/static/images/avatar/${councillor.person.uuid}.jpg`}\r\n                    imgProps={{\r\n                      onError: e => {\r\n                        e.target.src =\r\n                          this.homeUrl + '/static/images/avatar/default.png'\r\n                      },\r\n                    }}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs>\r\n                  <Typography variant=\"h4\" gutterBottom>\r\n                    {councillor.person.name_zh}\r\n                  </Typography>\r\n                  <Box display=\"flex\">\r\n                    <Box pr={1} alignSelf=\"flex-end\">\r\n                      <Typography variant=\"body2\">報稱政治聯繫</Typography>\r\n                    </Box>\r\n                    <Box>\r\n                      <Typography variant=\"body1\">\r\n                        {councillor.political_affiliation}\r\n                      </Typography>\r\n                    </Box>\r\n                  </Box>\r\n\r\n                  <Box display=\"flex\">\r\n                    <Box pr={1} alignSelf=\"flex-end\">\r\n                      <Typography variant=\"body2\">\r\n                        {councillor.electionResults.lastParticipatedYear}\r\n                        選舉結果\r\n                      </Typography>\r\n                    </Box>\r\n                    <Box>\r\n                      <Typography variant=\"body1\">\r\n                        {councillor.lastElectionResult.diff === 0 && '自動當選'}\r\n                        {councillor.lastElectionResult.diff > 0 &&\r\n                          `${\r\n                            councillor.lastElectionResult.diff /\r\n                              councillor.lastElectionResult.votes >\r\n                            0.2\r\n                              ? '大'\r\n                              : councillor.lastElectionResult.diff /\r\n                                  councillor.lastElectionResult.votes <\r\n                                0.05\r\n                              ? '險'\r\n                              : ''\r\n                          }勝${councillor.lastElectionResult.diff}票`}\r\n                      </Typography>\r\n                    </Box>\r\n                  </Box>\r\n                </Grid>\r\n              </Grid>\r\n            </Box>\r\n          </UnstyledNavLink>\r\n        ))}\r\n      </PlainCard>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Councillor\r\n","import React, { useRef, useState, useEffect, useLayoutEffect } from 'react'\r\nimport * as d3 from 'd3'\r\nimport _ from 'lodash'\r\n\r\nexport default props => {\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 })\r\n\r\n  const d3Container = useRef(null)\r\n\r\n  const drawChart = data => {\r\n    if (dimensions.width === 0) {\r\n      return\r\n    }\r\n\r\n    const color = d3.scaleOrdinal().range(['#ca0020', '#f4a582'])\r\n\r\n    const margin = { top: 50, right: 20, bottom: 30, left: 40 }\r\n\r\n    const width = dimensions.width - margin.left - margin.right\r\n    const height = dimensions.width - margin.top - margin.bottom\r\n\r\n    const max = _.max(_.maxBy(data, r => _.max(r.values)).values)\r\n\r\n    const svg = d3\r\n      .select(d3Container.current)\r\n      .attr('width', width + margin.left + margin.right)\r\n      .attr('height', height + margin.top + margin.bottom)\r\n\r\n    svg.selectAll('g').remove()\r\n    const chart = svg\r\n      .append('g')\r\n      .attr('transform', `translate(${margin.left}, ${margin.top})`)\r\n\r\n    const yScale = d3\r\n      .scaleLinear()\r\n      .range([height, 0])\r\n      .domain([0, max]) // space for showing legend\r\n\r\n    const x0 = d3\r\n      .scaleBand()\r\n      .range([0, width])\r\n      .domain(data.map(s => s.label))\r\n      .padding(0.1)\r\n\r\n    const x1 = d3\r\n      .scaleBand()\r\n      .domain(d3.range(2))\r\n      .range([0, x0.bandwidth() - 10])\r\n    // y axis\r\n    chart.append('g').call(d3.axisLeft(yScale))\r\n\r\n    // draw the lines\r\n    chart\r\n      .append('g')\r\n      .style('color', 'lightgrey')\r\n      .style('stroke-opacity', '0.7')\r\n      .call(\r\n        d3\r\n          .axisLeft(yScale)\r\n          .tickSizeOuter(0)\r\n          .tickSizeInner(-width)\r\n          .tickFormat('')\r\n      )\r\n\r\n    // x axis\r\n    chart\r\n      .append('g')\r\n      .attr('transform', `translate(0, ${height})`)\r\n      .call(d3.axisBottom(x0))\r\n      .selectAll('text')\r\n      .attr('transform', 'translate(0,0)rotate(-45)')\r\n      .style('text-anchor', 'end')\r\n      .style('fill', '#69a3b2')\r\n\r\n    const slice = svg\r\n      .selectAll('.slice')\r\n      .data(data)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'g')\r\n      .attr(\r\n        'transform',\r\n        d => `translate(${x0(d.label) + margin.left + 5},${margin.top})`\r\n      )\r\n\r\n    slice\r\n      .selectAll('rect')\r\n      .data(d => d.values)\r\n      .enter()\r\n      .append('rect')\r\n      .attr('width', x1.bandwidth())\r\n      .attr('x', (d, i) => x1(i))\r\n      .attr('y', d => yScale(0))\r\n      .attr('height', d => height - yScale(0))\r\n      .style('fill', (d, i) => color(i))\r\n\r\n    slice\r\n      .selectAll('rect')\r\n      .transition()\r\n      .delay(function(d) {\r\n        return Math.random() * 1000\r\n      })\r\n      .duration(1000)\r\n      .attr('y', d => yScale(d))\r\n      .attr('height', d => height - yScale(d))\r\n\r\n    //Legend\r\n    const legend = svg\r\n      .selectAll('.legend')\r\n      .data(data[0].labels)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'legend')\r\n      .attr('transform', (d, i) => `translate(0, ${i * 20})`)\r\n\r\n    legend\r\n      .append('rect')\r\n      .attr('x', width - 20)\r\n      .attr('width', 14)\r\n      .attr('height', 14)\r\n      .style('fill', function(d) {\r\n        return color(d)\r\n      })\r\n\r\n    legend\r\n      .append('text')\r\n      .attr('x', width)\r\n      .attr('y', 7)\r\n      .attr('dy', '.35em')\r\n      .style('text-anchor', 'start')\r\n      .text(function(d) {\r\n        return d\r\n      })\r\n  }\r\n\r\n  useEffect(() => {\r\n    drawChart(props.data)\r\n  })\r\n\r\n  useLayoutEffect(() => {\r\n    if (d3Container.current) {\r\n      setDimensions({\r\n        width: d3Container.current.clientWidth,\r\n      })\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <>\r\n      <svg\r\n        ref={d3Container}\r\n        style={{ height: dimensions.width, width: '100%' }}\r\n      ></svg>\r\n    </>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport GroupedBarChart from 'components/charts/GroupedBarChart'\r\nimport { Query } from 'react-apollo'\r\nimport _ from 'lodash'\r\nimport { QUERY_CONSTITUENCY_STATS } from 'queries/gql'\r\nimport { Button, Typography } from '@material-ui/core'\r\n\r\nexport default props => {\r\n  const filters = [null, 'FEMALE', 'MALE']\r\n  const [filterIndex, setFilterIndex] = useState(0)\r\n\r\n  const changeFilter = () => {\r\n    let index = filterIndex + 1\r\n    if (index === filters.length) {\r\n      index = 0\r\n    }\r\n    setFilterIndex(index)\r\n  }\r\n\r\n  const getDataForChat = voteStats => {\r\n    /**\r\n     * voteStats = [{\r\n     *  type: \"BY_GENDER_AGE\",\r\n     *  subtype: \"VOTERS/NEW_VOTERS\",\r\n     *  category_1: \"FEMALE/MALE\",\r\n     *  category_2: \"21-25\"\r\n     *  count: 10\r\n     * }]\r\n     */\r\n\r\n    const isFiltered = gender => {\r\n      if (gender === 'MALE' && filterIndex === 1) {\r\n        return false\r\n      } else if (gender === 'FEMALE' && filterIndex === 2) {\r\n        return false\r\n      }\r\n      return true\r\n    }\r\n    const data = _.values(_.groupBy(voteStats, stat => stat.category_2))\r\n    data.forEach(row => {\r\n      row.label = row[0].category_2\r\n      row.values = _.values(_.groupBy(row, r => r.subtype)).map(r =>\r\n        r\r\n          .filter(v => isFiltered(v.category_1))\r\n          .map(v => v.count)\r\n          .reduce((c, v) => c + v, 0)\r\n      )\r\n      row.values = [row.values[0] - row.values[1], row.values[0]]\r\n      row.labels = ['2018', '2019']\r\n    })\r\n\r\n    /**\r\n     * [{\r\n     *  label: \"21-22\",\r\n     *  values: [200, 159] // -> 2019 vs 2018\r\n     * }]\r\n     */\r\n\r\n    return data\r\n  }\r\n\r\n  const getMeta = voteStats => {\r\n    const meta = {\r\n      increased: 0,\r\n      mostIncreasedGroup: null,\r\n    }\r\n    const total = voteStats\r\n      .filter(v => v.subtype === 'VOTERS')\r\n      .map(v => v.count)\r\n      .reduce((c, v) => c + v, 0)\r\n\r\n    const newVotes = voteStats\r\n      .filter(v => v.subtype === 'NEW_VOTERS')\r\n      .map(v => v.count)\r\n      .reduce((c, v) => c + v, 0)\r\n\r\n    let max = 0\r\n    const groupedByAge = _.groupBy(voteStats, v => v.category_2)\r\n    Object.keys(groupedByAge).forEach(age => {\r\n      const genders = groupedByAge[age]\r\n      const groupedByGender = _.groupBy(genders, v => v.category_1)\r\n      Object.keys(groupedByGender).forEach(gender => {\r\n        const types = groupedByGender[gender]\r\n        const groupedByType = _.groupBy(types, v => v.subtype)\r\n        const newVoters = groupedByType['NEW_VOTERS'][0].count\r\n        const totalVoters = groupedByType['VOTERS'][0].count\r\n        if (newVoters / totalVoters > max) {\r\n          max = _.round(newVoters / totalVoters, 4)\r\n          meta.mostIncreasedGroup = {\r\n            gender,\r\n            age,\r\n            max,\r\n          }\r\n        }\r\n      })\r\n    })\r\n    // .filter(v => v.subtype === 'NEW_VOTERS')\r\n    // .forEach(v => {\r\n    //   if (v.count > max) {\r\n    //     meta.mostIncreasedGroup = {\r\n    //       gender: v.category_1,\r\n    //       age: v.category_2\r\n    //     }\r\n    //   }\r\n    // })\r\n    meta.increased = _.round(newVotes / total, 4)\r\n\r\n    return meta\r\n  }\r\n\r\n  return (\r\n    // TODO: support page other than battleground page\r\n    <>\r\n      <Query\r\n        query={QUERY_CONSTITUENCY_STATS}\r\n        variables={{ year: 2019, code: props.code }}\r\n      >\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n\r\n          if (data.dcd_constituencies.length === 0) {\r\n            console.error(`cannot find constituency. code: ${props.code}`)\r\n            return `Error!`\r\n          }\r\n          // transform the data to desire format\r\n          const chartData = getDataForChat(\r\n            data.dcd_constituencies[0].vote_stats\r\n          )\r\n          const meta = getMeta(data.dcd_constituencies[0].vote_stats)\r\n          return (\r\n            <>\r\n              <Typography variant=\"h2\">\r\n                選民增加{_.round(meta.increased * 100, 2)}%\r\n              </Typography>\r\n              <Typography variant=\"h4\">\r\n                {meta.mostIncreasedGroup.age}歲的\r\n                {meta.mostIncreasedGroup.gender === 'MALE' ? '男' : '女'}\r\n                性選民增加了\r\n                {_.round(meta.mostIncreasedGroup.max * 100, 2)}%\r\n              </Typography>\r\n              <Button onClick={changeFilter}>\r\n                {filterIndex === 0\r\n                  ? '顯示所有'\r\n                  : filterIndex === 1\r\n                  ? '只顯示男性選民'\r\n                  : '只顯示女性選民'}\r\n              </Button>\r\n              <GroupedBarChart data={chartData} />\r\n            </>\r\n          )\r\n        }}\r\n      </Query>\r\n    </>\r\n  )\r\n}\r\n","import styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\n\r\nexport default styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    width: 100%;\r\n    margin: auto;\r\n  }\r\n`\r\n","import styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\n\r\nexport default styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: column;\r\n    flex-wrap: wrap;\r\n    align-items: flex-start;\r\n    width: 100%;\r\n    margin: auto;\r\n  }\r\n`\r\n","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward'\r\nimport { Tag } from '../atoms/Tag'\r\nimport { Button } from '@material-ui/core'\r\nimport DistrictNewVoterChartContainer from 'components/containers/DistrictNewVoterChartContainer'\r\nimport Columns from 'components/atoms/Columns'\r\nimport Rows from 'components/atoms/Rows'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport KeyboardArrowUp from '@material-ui/icons/KeyboardArrowUp'\r\nconst Container = styled(Paper)`\r\n  && {\r\n    width: 100%;\r\n    padding: 16px;\r\n    box-shadow: none;\r\n  }\r\n`\r\n\r\nclass DCCAOverview extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      showGraph: false,\r\n    }\r\n  }\r\n\r\n  renderPrevElectionButton(year) {\r\n    return year > 1999 ? (\r\n      <IconButton aria-label=\"arrow_back\" onClick={this.props.onPrevElection}>\r\n        <ArrowBackIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the right\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  renderNextElectionButton(year) {\r\n    const nextElectionYear = year + 4\r\n    const currentYear = new Date().getFullYear()\r\n    return nextElectionYear <= currentYear ? (\r\n      <IconButton\r\n        aria-label=\"arrow_forward\"\r\n        onClick={this.props.onNextElection}\r\n      >\r\n        <ArrowForwardIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the left\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  toggleGraph() {\r\n    this.setState({\r\n      showGraph: !this.state.showGraph,\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { name_zh, year, code, dc_name_zh, tags, voterData } = this.props\r\n\r\n    const new_voters_percentage = (\r\n      (100 * voterData.aggregations.new_voters) /\r\n      voterData.aggregations.all_voters\r\n    ).toFixed(2)\r\n    return (\r\n      <Container>\r\n        <Rows>\r\n          <Columns>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              {year} {dc_name_zh}\r\n            </Typography>\r\n            {tags.map((tag, index) => (\r\n              <Tag key={index} value={tag.tag} />\r\n            ))}\r\n          </Columns>\r\n\r\n          <Columns>\r\n            <Typography variant=\"h3\" style={{ display: 'inline-block' }}>\r\n              {name_zh}\r\n            </Typography>\r\n            <Typography\r\n              variant=\"h5\"\r\n              style={{ display: 'inline-block', marginLeft: '8px' }}\r\n            >\r\n              {code}\r\n            </Typography>\r\n          </Columns>\r\n\r\n          <Button onClick={this.toggleGraph.bind(this)}>\r\n            <Typography variant=\"h6\">\r\n              選民人數 {voterData.aggregations.all_voters}{' '}\r\n              {`(${\r\n                new_voters_percentage > 0 ? '+' : '-'\r\n              }${new_voters_percentage}%)`}\r\n            </Typography>\r\n            {this.state.showGraph ? (\r\n              <KeyboardArrowUp fontSize=\"small\" />\r\n            ) : (\r\n              <ExpandMoreIcon fontSize=\"small\" />\r\n            )}\r\n          </Button>\r\n          {this.state.showGraph && (\r\n            <DistrictNewVoterChartContainer code={code} />\r\n          )}\r\n        </Rows>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DCCAOverview\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport DCCACompareMap from '../../components/DCCACompareMap'\r\nimport { Query } from 'react-apollo'\r\nimport MainAreas from 'components/district/MainAreas'\r\nimport Councillor from 'components/district/Councillor'\r\nimport CandidateList from 'components/district/CandidateList'\r\nimport DCCAOverview from 'components/district/DCCAOverview'\r\nimport Button from '@material-ui/core/Button'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport _ from 'lodash'\r\nimport { QUERY_CONSTITUENCIES } from 'queries/gql'\r\n\r\nconst groupVoteStat = voteStats => {\r\n  const data = _.groupBy(voteStats, stat => stat.subtype)\r\n  data.aggregations = {\r\n    all_voters: data.VOTERS.map(v => v.count).reduce((c, v) => c + v, 0),\r\n    new_voters: data.NEW_VOTERS.map(v => v.count).reduce((c, v) => c + v, 0),\r\n  }\r\n  return data\r\n}\r\nclass BattleGroundPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      showMap: false,\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //  if (this.props.route.path === nextProps.route.path) return false;\r\n    return true\r\n  }\r\n\r\n  handleCandidateSelected = candidateId => {\r\n    this.props.history.push(`/profile/${candidateId}`)\r\n  }\r\n\r\n  handleChangeDistrict = (year, code) => {\r\n    if (!year || !code) return\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  onPrevElection() {\r\n    const {\r\n      match: {\r\n        params: { code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/2015/${code}`)\r\n  }\r\n\r\n  onNextElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) + 4}/${code}`)\r\n  }\r\n\r\n  render() {\r\n    const { showMap } = this.state\r\n    const {\r\n      match: {\r\n        params: { year = 2019, code },\r\n      },\r\n    } = this.props\r\n\r\n    return (\r\n      <>\r\n        <Query query={QUERY_CONSTITUENCIES} variables={{ year, code }}>\r\n          {({ loading, error, data }) => {\r\n            if (loading) return null\r\n            if (error) return `Error! ${error}`\r\n            const district = data.dcd_constituencies[0]\r\n            const last_districts = district.predecessors\r\n\r\n            return (\r\n              <>\r\n                <DCCAOverview\r\n                  year={year}\r\n                  name_zh={district.name_zh}\r\n                  dc_name_zh={district.district.dc_name_zh}\r\n                  code={district.code}\r\n                  tags={district.tags}\r\n                  voterData={groupVoteStat(district.vote_stats)}\r\n                />\r\n                <Button onClick={() => this.setState({ showMap: !showMap })}>\r\n                  {showMap ? '隱藏地圖' : '顯示地圖'}\r\n                  <ExpandMoreIcon />\r\n                </Button>\r\n                <Collapse in={showMap}>\r\n                  <Box\r\n                    width={{ sm: '100%', md: '960px' }}\r\n                    height={{ sm: '300px', md: '400px' }}\r\n                  >\r\n                    <DCCACompareMap\r\n                      year={year}\r\n                      code={code}\r\n                      changeDistrict={this.handleChangeDistrict}\r\n                    />\r\n                  </Box>\r\n                </Collapse>\r\n                <MainAreas areas={district.main_areas || []} />\r\n                <Councillor districts={last_districts} />\r\n                <CandidateList\r\n                  candidates={district.candidates}\r\n                  // year={parseInt(year, 10)}\r\n                  // code={code}\r\n                  // handleCandidateSelected={this.handleCandidateSelected}\r\n                />\r\n              </>\r\n            )\r\n          }}\r\n        </Query>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default BattleGroundPage\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\n\r\nexport const headingFontFamily = 'PingFangTC-Medium, sans-serif'\r\nexport const bodyFontFamily = 'PT Serif, sans-serif'\r\n\r\nexport const FONT_FAMILY = [\r\n  'PingFangTC',\r\n  'Noto Sans TC',\r\n  'sans-serif',\r\n  '-apple-system',\r\n  '\"Helvetica Neue\"',\r\n  'Arial',\r\n]\r\n\r\nexport const typography = {\r\n  useNextVariants: true,\r\n  fontSize: 16,\r\n  fontFamily: FONT_FAMILY.join(','),\r\n  h1: {\r\n    fontFamily: headingFontFamily,\r\n  },\r\n  h2: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 50,\r\n    fontWeight: 500,\r\n  },\r\n  h3: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 40,\r\n    fontWeight: 500,\r\n  },\r\n  h4: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 30,\r\n    fontWeight: 500,\r\n  },\r\n  h5: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 24,\r\n    fontWeight: 500,\r\n  },\r\n  h6: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 18,\r\n    fontWeight: 500,\r\n  },\r\n  body1: {\r\n    fontFamily: bodyFontFamily,\r\n  },\r\n}\r\n\r\nexport default createMuiTheme({\r\n  typography,\r\n  palette: {\r\n    primary: {\r\n      light: '#ffffff',\r\n      main: '#000000',\r\n      dark: '#cccccc',\r\n    },\r\n    secondary: {\r\n      light: '#2c2c2c',\r\n      main: '#000000',\r\n      dark: '#000000',\r\n    },\r\n    background: {\r\n      default: '#ffffff',\r\n    },\r\n    button: {\r\n      primary: '#ffd731',\r\n      secondary: '#ffd731',\r\n    },\r\n  },\r\n})\r\n","import React, { Component } from 'react'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport createMuiTheme from '../../ui/theme'\r\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider'\r\n\r\nconst theme = createMuiTheme\r\n\r\nconst styles = theme => ({\r\n  content: {},\r\n})\r\n\r\nclass NotFoundPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        TODO - <a href=\"https://notfound.collaction.hk/\">404</a>\r\n      </MuiThemeProvider>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(NotFoundPage)\r\n","import React from 'react'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport SearchIcon from '@material-ui/icons/Search'\r\nimport styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { DRAWER_OPEN } from '../../reducers/drawer'\r\nimport ContextStore from 'ContextStore'\r\nimport { UnstyledNavLink } from '../atoms/UnstyledLink'\r\n\r\nconst StyledAppBar = styled(AppBar)`\r\n  && {\r\n    width: 100%;\r\n    box-shadow: none;\r\n  }\r\n`\r\n\r\nconst AppBarTitle = styled(UnstyledNavLink)`\r\n  && {\r\n    left: auto;\r\n    right: auto;\r\n    width: 100%;\r\n    position: absolute;\r\n  }\r\n`\r\n\r\nfunction MobileAppBar(props) {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n\r\n  return (\r\n    <>\r\n      <StyledAppBar position=\"sticky\" color=\"primary\">\r\n        <Toolbar disableGutters>\r\n          <AppBarTitle to={'/'}>\r\n            <Typography variant=\"h3\" align=\"center\">\r\n              <span role=\"img\">區議會 ✋🧡⚡</span>\r\n            </Typography>\r\n          </AppBarTitle>\r\n\r\n          <IconButton\r\n            color=\"inherit\"\r\n            component=\"span\"\r\n            aria-label=\"Search\"\r\n            onClick={() => dispatch({ type: DRAWER_OPEN })}\r\n          >\r\n            <SearchIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </StyledAppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MobileAppBar\r\n","import React from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport styled from 'styled-components'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { UnstyledLink } from 'components/atoms/UnstyledLink'\r\nimport { Typography } from '@material-ui/core'\r\n\r\nconst StyledFooter = styled(Box)`\r\n  && {\r\n    border-top: 1px rgba(0, 0, 0, 0.12) solid;\r\n    margin: 16px 16px 0;\r\n    padding: 16px 0;\r\n  }\r\n`\r\n\r\nconst StyledDivider = styled(Divider)`\r\n  && {\r\n    margin: 16px 0;\r\n  }\r\n`\r\n\r\nconst StyledFooterLink = styled(UnstyledLink)`\r\n  && {\r\n    color: rgba(0, 0, 0, 0.87);\r\n  }\r\n`\r\n\r\nfunction Footer(props) {\r\n  return (\r\n    <>\r\n      <StyledFooter>\r\n        <Typography variant=\"body2\" gutterBottom>\r\n          本網站所刊載資訊全為公開資料，歸納自選舉管理委員會丶選舉事務處丶政府統計處丶各區區議會網站及\r\n          <a href=\"https://github.com/initiummedia/hk_district_council_election\">\r\n            端傳媒\r\n          </a>\r\n          ，刊載前已盡力確保資料真確性，如有建議或錯漏，請按下方連結回報。\r\n        </Typography>\r\n        <Typography variant=\"body2\">\r\n          本網站與任何2019年區議會選舉候選人或其助選成員無關，刊載資料目的非為促使或阻礙任何候選人在選舉中當選。\r\n        </Typography>\r\n        <StyledDivider />\r\n        <Box display=\"flex\" alignContent=\"flex-start\">\r\n          <Box pr={3}>\r\n            <StyledFooterLink\r\n              target=\"_blank\"\r\n              href=\"https://www.facebook.com/g0vhk.io\"\r\n            >\r\n              關於g0vhk.io\r\n            </StyledFooterLink>\r\n          </Box>\r\n          <Box pr={3}>\r\n            <StyledFooterLink\r\n              target=\"_blank\"\r\n              href=\"https://forms.gle/irD6tEznWPNda6w59\"\r\n            >\r\n              反映意見\r\n            </StyledFooterLink>\r\n          </Box>\r\n          <Box>\r\n            <StyledFooterLink\r\n              target=\"_blank\"\r\n              href=\"https://github.com/cswbrian/district-councils-dashboard\"\r\n            >\r\n              GitHub\r\n            </StyledFooterLink>\r\n          </Box>\r\n        </Box>\r\n      </StyledFooter>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Footer\r\n","import React from 'react'\r\nimport GoogleAnalytics from 'react-ga'\r\n\r\nconst trackingId = process.env.REACT_APP_GA_TRACKING_ID\r\nif (!trackingId) {\r\n  throw new Error(\r\n    'Invalid google tracking ID. or set to UA-000000-01 if you dont have any'\r\n  )\r\n}\r\nGoogleAnalytics.initialize(trackingId)\r\n\r\nconst withTracker = (WrappedComponent, options = {}) => {\r\n  const trackPage = page => {\r\n    GoogleAnalytics.set({\r\n      page,\r\n      ...options,\r\n    })\r\n    GoogleAnalytics.pageview(page)\r\n  }\r\n\r\n  const HOC = class extends React.Component {\r\n    componentDidMount() {\r\n      const page = this.props.location.pathname\r\n      trackPage(page)\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n      const currentPage = this.props.location.pathname\r\n      const nextPage = nextProps.location.pathname\r\n\r\n      if (currentPage !== nextPage) {\r\n        trackPage(nextPage)\r\n      }\r\n    }\r\n\r\n    render() {\r\n      return <WrappedComponent {...this.props} />\r\n    }\r\n  }\r\n\r\n  return HOC\r\n}\r\n\r\nexport default withTracker\r\n","import React from 'react'\r\nimport { Route, Switch } from 'react-router-dom'\r\nimport CssBaseline from '@material-ui/core/CssBaseline'\r\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider'\r\nimport { ThemeProvider } from 'styled-components/'\r\nimport IndexPage from './pages'\r\nimport SearchPage from './pages/search'\r\nimport ProfilePage from './pages/profile'\r\nimport DistrictPage from './pages/district'\r\nimport BattleGroundPage from './pages/battleground'\r\nimport NotfoundPage from './pages/notfound'\r\nimport ApolloClient from 'apollo-boost'\r\nimport { ApolloProvider } from 'react-apollo'\r\nimport theme, { styledComponentTheme } from 'ui/theme/main'\r\nimport './App.css'\r\nimport Box from '@material-ui/core/Box'\r\nimport styled from 'styled-components'\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport MobileAppBar from './components/organisms/MobileAppBar'\r\nimport Footer from './components/organisms/Footer'\r\nimport drawerReducer from 'reducers/drawer'\r\nimport ContextStore, { drawerInitialState } from 'ContextStore'\r\nimport withTracker from './WithTracker'\r\n\r\nconst client = new ApolloClient({\r\n  uri: process.env.REACT_APP_GRAPHQL_URI,\r\n})\r\n\r\nconst Root = styled(Box)`\r\n  && {\r\n    height: 100%;\r\n    display: flex;\r\n    margin: auto;\r\n    overflow: hidden;\r\n    background-color: white;\r\n  }\r\n`\r\n\r\nconst ContentContainer = styled(Box)`\r\n  && {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 100%;\r\n    max-width: 1024px;\r\n    margin: auto;\r\n    overflow: auto;\r\n  }\r\n`\r\n\r\nconst Wrapper = styled(Box)`\r\n  && {\r\n    flex: 1;\r\n  }\r\n`\r\n\r\nconst App = props => {\r\n  if (!process.env.REACT_APP_GRAPHQL_URI) {\r\n    throw new Error('Graphql host not yet set')\r\n  }\r\n\r\n  const [drawerState, drawerDispatch] = React.useReducer(\r\n    drawerReducer,\r\n    drawerInitialState\r\n  )\r\n\r\n  return (\r\n    <ApolloProvider client={client}>\r\n      <ThemeProvider theme={styledComponentTheme}>\r\n        <MuiThemeProvider theme={theme}>\r\n          <ContextStore.Provider\r\n            value={{\r\n              drawer: {\r\n                state: drawerState,\r\n                dispatch: drawerDispatch,\r\n              },\r\n            }}\r\n          >\r\n            <Root>\r\n              <ContentContainer>\r\n                <CssBaseline />\r\n                <Wrapper>\r\n                  <MobileAppBar />\r\n                  <main>\r\n                    <Switch>\r\n                      <Route\r\n                        exact\r\n                        path=\"/\"\r\n                        component={withTracker(IndexPage)}\r\n                      />\r\n                      <Route\r\n                        path=\"/profile/:name/:uuid\"\r\n                        component={withTracker(ProfilePage)}\r\n                      />\r\n                      <Route\r\n                        path=\"/district/2019/:code\"\r\n                        component={withTracker(BattleGroundPage)}\r\n                      />\r\n                      <Route\r\n                        path=\"/district/:year/:code\"\r\n                        component={withTracker(DistrictPage)}\r\n                      />\r\n                      <Route component={withTracker(NotfoundPage)} />\r\n                    </Switch>\r\n                  </main>\r\n                </Wrapper>\r\n                <Footer />\r\n              </ContentContainer>\r\n              <Drawer\r\n                anchor=\"left\"\r\n                open={drawerState.open}\r\n                variant=\"persistent\"\r\n              >\r\n                <SearchPage />\r\n              </Drawer>\r\n            </Root>\r\n          </ContextStore.Provider>\r\n        </MuiThemeProvider>\r\n      </ThemeProvider>\r\n    </ApolloProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport { BrowserRouter as Router } from 'react-router-dom'\r\nimport App from './App'\r\n\r\nimport './index.css'\r\n\r\nReactDOM.render(\r\n  <Router>\r\n    <App />\r\n  </Router>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}